<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>JIRA Integration to Cisco Spark</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.2.3/foundation.min.css" rel="stylesheet" type="text/css"> 
<link href="https://d24wgzqqegxpap.cloudfront.net/api/css/collab-ui-min.css" rel="stylesheet" type="text/css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.2.3/foundation.min.js"></script> 
<script type="text/javascript" src="https://d24wgzqqegxpap.cloudfront.net/api/js/porthole.min.js"></script>
<script src="https://d24wgzqqegxpap.cloudfront.net/api/js/jquery.multiselect.js"></script>
<link href="https://d24wgzqqegxpap.cloudfront.net/api/css/jquery.multiselect.css" rel="stylesheet" type="text/css">
<link href="https://183.82.99.100:8443/CiscoWebcontent/css/styles.css" rel="stylesheet" type="text/css">
<link href="https://183.82.99.100:8443/CiscoWebcontent/css/select2.min.css" rel="stylesheet" />
<script type="text/javascript" src="https://183.82.99.100:8443/CiscoWebcontent/js/scriptsRoom.js"></script> 
<script src="https://183.82.99.100:8443/CiscoWebcontent/js/select2.min.js"></script> 
<style>
.spark-config-block{border-top:0px;margin:0px auto;}
.jira-domain-block{margin-let:10px auto !important;}
.columns.domain-btn {
    margin-left: 34%;
}
.issutypes.multicheckbox-input-small-mobile {
    margin-left: -60px;
}
.jira-event-tooltip {
    left: 32%;
    position: absolute;
}
.add-custom-type {
    margin-left: 32% !important;
    position: absolute;
    width: 110%;
}
.large-6.medium-8.columns.unauthissuetypes {
    width: 68%;
}
.large-9.medium-8.columns.text.left.projects {
    margin-left: 32px !important;
}
#projects{width:231px !important;}
.spark-marketplace {width:30%;float:left;}
.iframe {width:70%;float:right;padding: 3rem;}
#token {margin-bottom: 15px;}
@media screen and (max-width: 600px) {
	.spark-marketplace {width:100%;}
	.iframe {width:100%;float:left;padding: 1.375rem;}
} 
.unauth {
    margin-bottom: 34px;
}
.auth {
    margin-bottom: 34px;
}
.jira-auth-btn {
    text-align: center;
    margin-top: 34px;
}
.jira-baseurl-tooltip{
margin-top:-8px !important;
}
.jira-config-name{margin: 0 0 9px -7px !important;}
.jira-steps{margin-bottom:5px;}
</style>
<script>
integration_app_icon_url="https://d24wgzqqegxpap.cloudfront.net/api/images/jira/jira.png";
var spark_icon_url="https://d24wgzqqegxpap.cloudfront.net/api/images/spark-icon.png";
var protocol = "http://";
var domain = ".atlassian.com";
var selectedRoomName = "";
var displayName = "";
var jiraBaseURL="";
var statusJSON = "";
var selected_room_id="0";
var urlResponse = false;
var otherEventSelectedValues = [];
var allEventStatus = false;
var isSprintBoard = false;
var issueTypesText;
var appTokenExists = false;
authenticationFlag = false;
var editStatusJson ={};
var formAction  = "";
var action = "";
var token = "";
var id  = "";
var UUID = "";
$( document ).ready(function() { 
		$("#action-add-config").click(function (e){
			console.log("here");
			id = $("#intId").val();
			token = $("#token").val();
			action = $("#action").val();
			if(id==0){alert("Please select Integration");} else { 
				sessionStorage.setItem('userId', token);
				sessionStorage.setItem('integrationId', id)
			}
				action=action.toLowerCase();
				if(action=="connect") {
					formAction = "connect";
					$("#integrations-block").hide();
					$('#integration-form').hide();
					$(".unauth-config-block").hide();
					connectIntegration();
					validateIntegrationAppToken();
				} else if(action=="disconnect") {
					formAction="disconnect";
					removeAllIntegrationInstances(formAction);
				} else {
					formAction = "list";
					$(".unauth-config-block").show();
					appTokenExists = true;
					jiraListIntegrations();
				}
		});
	
		//$('#authenticate-block').show();
		$("#jira-icon").attr("src", integration_app_icon_url);
		$(".spark-icon").attr("src", spark_icon_url);
		expandSetup();
		$('#integrations-block').hide();
		$('#integration-form').hide();
		$("#expand-close").addClass("closearrow");
		$('#expand-close').click(function(e){
			e.preventDefault();
			if($(this).attr('class')=='closearrow'){
				 $('#showSetup').hide();
				 $(this).removeClass("closearrow");
				 $(this).addClass("expandarrow");
				 $('.expandarrow').attr('title','expand');
			}else{
				$(this).addClass("closearrow");
				$(this).removeClass("expandarrow");
				$('.closearrow').attr('title','close');
				$('#showSetup').show();
			}
			resize();
		}); 
		$("#expand-close-config").addClass("closearrow");
		$('#expand-close-config').click(function(e){
			e.preventDefault();
			if($(this).attr('class')=='closearrow'){
				$('#showConfig').hide();
				 $(this).removeClass("closearrow");
				 $(this).addClass("expandarrow");
				 $('.expandarrow').attr('title','expand');
			}else{
				$(this).addClass("closearrow");
				$(this).removeClass("expandarrow");
				$('.closearrow').attr('title','close');
				$('#showConfig').show();
			}
			resize();
		});
		$("#unauth-expand-close-config").addClass("closearrow");
		$('#unauth-expand-close-config').click(function(e){
			e.preventDefault();
			if($(this).attr('class')=='closearrow'){
				$('#unauth-showConfig').hide();
				 $(this).removeClass("closearrow");
				 $(this).addClass("expandarrow");
				 $('.expandarrow').attr('title','expand');
			}else{
				$(this).addClass("closearrow");
				$(this).removeClass("expandarrow");
				$('.closearrow').attr('title','close');
				$('#unauth-showConfig').show();
			}
			resize();
		});
		$("#intruction-expand-close-config").addClass("closearrow");
		$('#intruction-expand-close-config').click(function(e){
			e.preventDefault();
			if($(this).attr('class')=='closearrow'){
				 $("#showSetup").hide();
				 $(this).removeClass("closearrow");
				 $(this).addClass("expandarrow");
				 $('.expandarrow').attr('title','expand');
			}else{
				$(this).addClass("closearrow");
				$(this).removeClass("expandarrow");
				$('.closearrow').attr('title','close');
				$("#showSetup").show();
			}
			resize();
		});
		$(".closearrow").mouseover(function(){
			$('.closearrow').attr('title','close');
		});
		$(".unauth-link").click(function(){
			getUnauth();
		});
		$(".unauth-form-link").click(function(){
			getUnauth();
		});
		$(".auth-link").click(function(){
			console.log("in link clicked!!!!!!!!!");
			$('.unauth').hide();
			$('.jira-data').hide();
			authenticationFlag = true;
			validateLink=true;
			$(".auth").hide();
			$('.config-info').hide();
			$("#unauth-showConfig").hide();
			$('.instructions-config-info').hide();
			$('.second-step').hide()
			$('#integration-form').hide();
			$('#integrations-block').hide();
			$(".jira-unauth").hide();
			validateIntegrationAppToken();
		});
		$(".red_cross_mark").click(function(){
			console.log("cliked cross mark!!!");
			$('.bot-err-msg').hide();
		});
		$(document).on("click", ".same-config-yes" , function(e) {
			$('#same-configuration').foundation('close');
			$("#integration-form").hide();
			jiraListIntegrations();
			$("#integrations-block").show();
		});
		$(document).on("click", ".same-config-no" , function(e) {
			console.log("no clicked!!!!!!!!!!!!!");
			$('#same-configuration').foundation('close');
		});
		$("#private_message").click(function(){
			if($(this).is(':checked')){
				selected_room_id="0";
				$("#rooms").val(selected_room_id);
				$('#select2-rooms-container').html($("#rooms option:selected").text());
				$("#rooms").prop("disabled", true);
			}else{
				$("#rooms").prop("disabled", false);
			}
		});
		$('#restricted-comments').change(function () {
			if ($(this).prop('checked')) {
				$('#newcomment').prop('checked', true);
			} 
		}); 
		$('#comment-edits').change(function () {
			if ($(this).prop('checked')) {
				$('#newcomment').prop('checked', true);
			} 
		});
		$('#newcomment').change(function () {
			if (!$(this).prop('checked')) {
				console.log("checked value!!!" + $(this).prop('checked'));
				$('#comment-edits').prop('checked', false);
				$('#restricted-comments').prop('checked', false);
			}
		}); 
		$('#issuetypes').multiselect({
			columns: 1,
			placeholder: 'Select Types',
			search: false,
			selectAll: false
		});
		$('#unauth-issuetypes').multiselect({
			columns: 1,
			placeholder: 'Select Types',
			search: false,
			selectAll: false
		});
		$('#issuestatus').multiselect({
			columns: 1,
			placeholder: 'Select Statuses',
			search: false,
			selectAll: false
		});
		$('.issuestatus div.ms-options > ul > li > ul > li').find(':checkbox').attr('name', 'status');
		$('.issuestatus div.ms-options > ul > li > ul > li').find(':checkbox').attr('class', 'status');
		$('.issuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('name', 'issuetype');
		$('.issuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('class', 'issuetype');
		$('.issuetypes div.ms-options > ul > li > ul > li input[value="All"]').attr('class', 'issuetypeall');
		$('.unauthissuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('name', 'unauthissuetype');
		$('.unauthissuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('class', 'unauthissuetype');
		$('.unauthissuetypes div.ms-options > ul > li > ul > li input[value="All"]').attr('class', 'unauthissuetypeall');
		$.fn.serializeObject1 = function(){
			var self = this,json = {},push_counters = {},patterns = {
					"validate": /^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,
					"key":      /[a-zA-Z0-9_]+|(?=\[\])/g,
					"push":     /^$/,
					"fixed":    /^\d+$/,
					"named":    /^[a-zA-Z0-9_]+$/
				};
			this.build = function(base, key, value){base[key] = value;return base;};
			this.push_counter = function(key){if(push_counters[key] === undefined){push_counters[key] = 0;}return push_counters[key]++;};
			$.each($(this).serializeArray(), function(){//skip invalid keys
				if(!patterns.validate.test(this.name)){ return; }
				var k,
					keys = this.name.match(patterns.key),
					merge = this.value,
					reverse_key = this.name;
				while((k = keys.pop()) !== undefined){
					reverse_key = reverse_key.replace(new RegExp("\\[" + k + "\\]$"), '');
					if(k.match(patterns.push)){merge = self.build([], self.push_counter(reverse_key), merge);}
					else if(k.match(patterns.fixed)){merge = self.build([], k, merge);}
					else if(k.match(patterns.named)){merge = self.build({}, k, merge);}
				}	json = $.extend(true, json, merge);
			});	        return json;
		}; 
		$("#issuestatus").val('');
		$("#issuetypes").val('');
		$("#unauth-issuetypes").val('');
		
		$("#projects").on("change",function() {
			var projectValue = $('#projects').val();
			if(projectValue!=0&&projectValue!=""){
				$('.unautheissuetypesblock').show();
			}else{
				$('.unautheissuetypesblock').hide();
			}
		});
		$("#issuetypes").on("change",function() {
			typeslength = $('input[name="issuetype"]:checked').length;
			var issueTpesArray = [];
			var issueTypesText;
			
			$(".issuetype:checked").each(function() {
				issueTpesArray.push($(this).val());
			});
			
			issueTypesText = issueTpesArray.join(',');

			if(typeslength >= 1){
			$('.issuetypes div.ms-options-wrap > button').html(issueTypesText);
			}else{
				$('.issuetypes div.ms-options-wrap > button').html("Select Types");
			}
			if(typeslength!=0){
				$(".config-info").show();
				$("#showConfig").show();
				$("#expand-close-config").removeClass("expandarrow");
				$("#expand-close-config").addClass("closearrow");
				$('.closearrow').attr('title','close');
			} else {
				$(".config-info").hide();
				$("#showConfig").hide();
			}
			$('.issuetypeall').change(function () {
				var flag = $(this).prop("checked");
				if(flag==true){ 
					$('.issuetypes div.ms-options-wrap > button').html("All"); 
				}else{
					$('.issuetypes div.ms-options-wrap > button').html("Select Types");
				}
				$(".issuetype").prop('checked', $(this).prop("checked"));
				 typeslength = $('input[class="issuetype"]:checked').length;
				 if(typeslength!=0){
					$(".config-info").show();
					$("#showConfig").show();
					$("#expand-close-config").removeClass("expandarrow");
					$("#expand-close-config").addClass("closearrow");
					$('.closearrow').attr('title','close');
				} else {
					$(".config-info").hide();
					$("#showConfig").hide();
				}	
			}); 
						
			$('.issuetype').change(function(){ 
				typeslength = $('input[class="issuetype"]:checked').length;
				$(".issuetype").each(function() { 
					if($(this).prop('checked')==false && typeslength<8){
						$(".issuetypeall").prop('checked',false);
					} else if(typeslength==8){
						$(".issuetypeall").prop('checked',true);
						$('.issuetypes div.ms-options-wrap > button').html("All"); 		
					}
				});
			});
			resize();
		});
		$("#unauth-issuetypes").on("change",function() {
			console.log("issue type on change!!!!!");
			typeslength = $('input[name="unauthissuetype"]:checked').length;
			var issueTpesArray = [];
			var issueTypesText;
			
			$(".unauthissuetype:checked").each(function() {
				issueTpesArray.push($(this).val());
			});
			
			issueTypesText = issueTpesArray.join(',');

			if(typeslength >= 1){
			$('.unauthissuetypes div.ms-options-wrap > button').html(issueTypesText);
			}else{
				$('.unauthissuetypes div.ms-options-wrap > button').html("Select Types");
			}
			if(typeslength!=0){
				$(".unauth-config-info").show();
				$("#unauth-showConfig").show();
				$("#expand-close-config").removeClass("expandarrow");
				$("#expand-close-config").addClass("closearrow");
				$('.closearrow').attr('title','close');
			} else {
				$(".config-info").hide();
				$("#unauth-showConfig").hide();
			}
			$('.unauthissuetypeall').change(function () {
				var flag = $(this).prop("checked");
				if(flag==true){ 
					$('.unauthissuetypes div.ms-options-wrap > button').html("All"); 
				}else{
					$('.unauthissuetypes div.ms-options-wrap > button').html("Select Types");
				}
				$(".unauthissuetype").prop('checked', $(this).prop("checked"));
				 typeslength = $('input[class="unauthissuetype"]:checked').length;
				 console.log("issue type on change typeslength!!!!!" +typeslength);
				 if(typeslength!=0){
					console.log("in types length!!!!");
					$(".unauth-config-info").show();
					$("#unauth-showConfig").show();
					$("#expand-close-config").removeClass("expandarrow");
					$("#expand-close-config").addClass("closearrow");
					$('.closearrow').attr('title','close');
				} else {
					$(".config-info").hide();
					$("#unauth-showConfig").hide();
				}	
			}); 
						
			$('.unauthissuetype').change(function(){ 
				typeslength = $('input[class="issuetype"]:checked').length;
				$(".unauthissuetype").each(function() { 
					if($(this).prop('checked')==false && typeslength<8){
						$(".unauthissuetypeall").prop('checked',false);
					} else if(typeslength==8){
						$(".unauthissuetypeall").prop('checked',true);
						$('.unauthissuetypes div.ms-options-wrap > button').html("All"); 		
					}
				});
			});
			resize();
		});
		$('input[type="checkbox"][class="otherevent-disable"]').click(function(){
			otherEventSelectedValues = [];
			isSprintBoard = false;
			$(".otherevent-disable:checked").each(function() {
				otherEventSelectedValues.push(this.value);
			});
		}); 
		 $('input[type="checkbox"][value="all"]').click(function(){
            if($(this).prop("checked") == true){
				$('.otherevent-disable').prop("disabled",true);
				$('.otherevent-disable').prop("checked",false);
				$('.otherevent-custom-disable').prop("disabled",true);
				$('.otherevent-custom-disable').prop("checked",false);
            } else if($(this).prop("checked") == false){
				if(formAction=="update"&&allEventStatus==true){
					$('.allevent-disable').prop("checked",false);
					$('.otherevent-disable').prop("checked",false);
					$('.otherevent-custom-disable').prop("checked",false);
					$('.otherevent-disable').prop("disabled",false);
					$('.otherevent-custom-disable').prop("disabled",false);
				}else{
					$('.otherevent-disable').prop("disabled",false);
					$('.otherevent-custom-disable').prop("checked",true);
					$('.otherevent-custom-disable').prop("disabled",false);
				}
				if(otherEventSelectedValues.length!=0){
					$.each(otherEventSelectedValues, function(index, value) {
						if(value!="all"){
							$("input[type=checkbox][value="+value+"][name=events]").prop("checked",true);
						}
					});
					 if(formAction=="update" && isSprintBoard==true){
						$.each(otherEventSelectedValues, function(index, value) {
							if(value=="sprint"||value=="board"){
								$("input[type=checkbox][value="+value+"][name=events]").prop("checked",false);
							}
						});
					} 
				}
				$('.otherevent-custom-disable').prop("checked",true);
				otherEventSelectedValues = [];
				$(".otherevent-disable:checked").each(function() {
					otherEventSelectedValues.push(this.value);
				});
            }
        });
		$('#add_customtypes').on('click',function(){
			allTypesArray = [];
			$("#unauth-issuetypes option").each(function(){
				allTypesArray.push($(this).val());
			});
			var customtype = $("#customtype_field").val();
			var count =0;
			var customTypecount = 0;
			if(customtype !="" && customtype!=null){
				var checkIssueType = customtype.replace(/\s/g, "");
				    checkIssueType = checkIssueType.toLowerCase();
				$.each(allTypesArray,function(index,value){
					if(value==checkIssueType ){
						count= count+1;
					}else allTypesArray.push(checkIssueType);
				});
				if(count==0){
					console.log("count 0!!!!!!!!!!");
					$("#unauth-issue-types-options").append($('<option>').attr('class','otherissuetypes').text(customtype).attr('value',checkIssueType).prop('selected', true));
					$('#unauth-issuetypes').multiselect('reload');
					$('.unauthissuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('name', 'unauthissuetype');
					$('.unauthissuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('class', 'unauthissuetype');
					$('.unauthissuetypes div.ms-options > ul > li > ul > li input[value="All"]').attr('class', 'unauthissuetypeall');
					$("#customtype_field").val('');
					if($('.unauthissuetypeall').is(':checked')){
						$(".unauthissuetype").prop('checked', true);
						$('.unauthissuetypes div.ms-options-wrap > button').html("All");
					}
					typeslength = $('input[name="issuetype"]:checked').length;
					issue_types_count = $('input[class="unauthissuetype"]').length;
					if(typeslength!=0){
						$(".config-info").show();
						$("#showConfig").show();
						$("#expand-close-config").removeClass("expandarrow");
						$("#expand-close-config").addClass("closearrow");
						$('.closearrow').attr('title','close');
						resize();
					} else {
						$(".config-info").hide();
						$("#showConfig").hide();
					}
				}else{
					alert("Please enter different issue type");
				}
			}else{
				alert("Please give your custom issue type");
			}
		});
		$('#add-other-events').on('click',function(){
			if($("#all").prop('checked') == true){
			}else{
				var otherEventName = $("#other-event-name").val();
				var otherEventValue = otherEventName.replace(/\s/g, "");
					otherEventValue = otherEventValue.toLowerCase();
				var count =0;
				allEventsArray = [];
				$("input[name=events]").each( function () {
				   allEventsArray.push($(this).val());
				});
				var length = $('#other_notifications div').last().parent().children().length;
				if(otherEventName =="" || otherEventName==null){
					alert("Please give your other event name.");
				} else{
					$.each(allEventsArray,function(index,value){
						if(value==otherEventValue){
							count= count+1;
						}
					});
					if(count==0){
						if(length==1){
						$('#other_notifications div').last().parent().append('<div class="large-3 medium-4 columns checkbox"><input name="events" id="'+otherEventValue+'" value="'+otherEventValue+'" type="checkbox" class="otherevent-custom-disable"><label for="'+otherEventValue+'">'+otherEventName+'</label></div>');
						$("input[type=checkbox][value="+otherEventValue+"][name=events]").prop("checked",true);
						}else{
							$('#other_notifications').append('<div class="large-12 medium-12 columns custom-event-remove"><div class="large-3 medium-4 columns checkbox"><input name="events" id="'+otherEventValue+'" value="'+otherEventValue+'" type="checkbox" class="otherevent-custom-disable"><label for="'+otherEventValue+'">'+otherEventName+'</label></div></div>');
							$("input[type=checkbox][value="+otherEventValue+"][name=events]").prop("checked",true);
						}
						$("#other-event-name").val("");
					}else{
						alert("Please enter different other event name.");
					}
				}
			}
			resize();
		});

});
function collapseAuthInstructions(){
	 $("#showSetup").hide();
	 $("#intruction-expand-close-config").removeClass("closearrow");
	 $("#intruction-expand-close-config").addClass("expandarrow");
	 $('.expandarrow').attr('title','expand');
}		
function expandAuthInstructions(){
	$("#showSetup").show();
	$("#intruction-expand-close-config").addClass("closearrow");
	$("#intruction-expand-close-config").removeClass("expandarrow");
	$('.closearrow').attr('title','close');
}				
function getDateForTimestamp(timestamp) {
		var datevalues="";
		if(timestamp!=0 || timestamp!=""|| timestamp!=null){
			var date = new Date(timestamp);
			var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
			datevalues=date.getDate()+nth(date.getDate())+" "+(months[date.getMonth()])+", "+ date.getFullYear();
		}
		return datevalues;
	}	
function jiraListIntegrations() {
    console.log("in jiraListIntegrations!!!!!!!!!!!!");
	var listDataHTML="";
	var authListDataHTML ="";
	$("#integration-form").hide();
	$("#integrations-block").show(); 
	$(".home").show();
	$('.unauth').show();
	if(authenticationFlag){
		console.log("authenticationFlag!!!" + authenticationFlag );
		if(appTokenExists){
			console.log("appTokenExists!!!" + appTokenExists );
			$('.auth').show();
			$(".unauth").show();
		}else{
			console.log("appTokenExists!!!else" + appTokenExists );
			$('.auth').show();
			$('.unauth').hide();
		}
	}else{
		console.log("authenticationFlag!!!else!!!" + authenticationFlag );
		$(".auth").show();
		$(".unauth").show();
		$("#integrations-block").hide();
	}
	if(formAction=="connect"){
		$('.unauth').show();
		$('.jira-data').show();
	}else if(formAction=="list"){
		console.log("in list action!!!");
		$('.unauth-link').show();
		$('.jira-data').hide();
		$("#integrations-block").show();
		$.each(listResultData, function(i, instance) {
			var configData=JSON.parse(instance.configJson);
			console.log("configData.oauth!!!" + configData.oauth);
			if(configData.oauth=="false"){
				listDataHTML+='<hr class="instance-hr"><div class="large-12 medium-12 columns instance-background">';
				listDataHTML+='<div class="large-8 medium-8 columns integration-details">';
				listDataHTML+='<img src="'+integration_app_icon_url+'" alt="">';
				listDataHTML+='<label>'+configData.displayName+'</label>';
				listDataHTML+='<label class="room">Space: '+instance.channelId+'</label>';
				listDataHTML+='<label class="date">Added: '+getDateForTimestamp(instance.createdDate)+'</label>';
				listDataHTML+='</div>';
				listDataHTML+='<div class="large-2 medium-2 columns edit-remove-icons">';
				listDataHTML+='<span class="cross-mark remove-config"></span><a class="edit-config" id='+instance.instanceId+'>Edit</a>'
				listDataHTML+='</div>';	
				console.log("listResultData!!!" + JSON.stringify(listResultData));
			}else{
				authListDataHTML+='<hr class="instance-hr"><div class="large-12 medium-12 columns instance-background">';
				authListDataHTML+='<div class="large-8 medium-8 columns integration-details">';
				authListDataHTML+='<img src="'+integration_app_icon_url+'" alt="">';
				authListDataHTML+='<label>'+configData.displayName+'</label>';
				authListDataHTML+='<label class="room">Space: '+instance.channelId+'</label>';
				authListDataHTML+='<label class="date">Added: '+getDateForTimestamp(instance.createdDate)+'</label>';
				authListDataHTML+='</div>';
				authListDataHTML+='<div class="large-2 medium-2 columns edit-remove-icons">';
				authListDataHTML+='<span class="cross-mark remove-config"></span><a class="edit-config" id='+instance.instanceId+'>Edit</a>'
				authListDataHTML+='</div>';	
				console.log("authListDataHTML!!!" + JSON.stringify(listResultData));
			}
		});
		$("#instance-list-block").html(listDataHTML);
		$("#unauth-instance-list-block").html(authListDataHTML);
	}else{
		$('.jira-data').hide();
		var formData = localStorage.getItem("jiraFormData");
		formData = JSON.parse(formData);
		if(formData!=null){
			if(formData.private_message!=undefined){
				selectedRoomName= "Bot";
			}else{
				selectedRoomName=$("#rooms option:selected").text();
			}
			$.ajax({
				url: list_instances_url,
				async: false,
				success: function(result){		
					$("#instance-list-block").show();
					console.log("localStorage.getItem('jiraFormData') " + localStorage.getItem("jiraFormData"));

					if(localStorage.getItem("jiraFormData")==null){
						console.log("in success if");
						$("#instance-list-block").html(listDataHTML);
					}else if(formData.issuetype==undefined&&formData.status==undefined&&formData.events==undefined){
						console.log("in else if!!!");
						$("#instance-list-block").html(listDataHTML);
					}else if(formAction!="remove") {
							console.log("in else");
						$.each(listResultData, function(i, instance) {
							var configData=JSON.parse(instance.configJson);
							if(configData.oauth=="false"){
								listDataHTML+='<hr class="instance-hr"><div class="large-12 medium-12 columns instance-background">';
								listDataHTML+='<div class="large-8 medium-8 columns integration-details">';
								listDataHTML+='<img src="'+integration_app_icon_url+'" alt="">';
								listDataHTML+='<label>'+configData.displayName+'</label>';
								listDataHTML+='<label class="room">Space: '+instance.channelId+'</label>';
								listDataHTML+='<label class="date">Added: '+getDateForTimestamp(instance.createdDate)+'</label>';
								listDataHTML+='</div>';
								listDataHTML+='<div class="large-2 medium-2 columns edit-remove-icons">';
								listDataHTML+='<span class="cross-mark remove-config"></span><a class="edit-config" id='+instance.instanceId+'>Edit</a>'
								listDataHTML+='</div>';	
								console.log("listResultData!!!" + JSON.stringify(listResultData));
							}else{
								authListDataHTML+='<hr class="instance-hr"><div class="large-12 medium-12 columns instance-background">';
								authListDataHTML+='<div class="large-8 medium-8 columns integration-details">';
								authListDataHTML+='<img src="'+integration_app_icon_url+'" alt="">';
								authListDataHTML+='<label>'+configData.displayName+'</label>';
								authListDataHTML+='<label class="room">Space: '+instance.channelId+'</label>';
								authListDataHTML+='<label class="date">Added: '+getDateForTimestamp(instance.createdDate)+'</label>';
								authListDataHTML+='</div>';
								authListDataHTML+='<div class="large-2 medium-2 columns edit-remove-icons">';
								authListDataHTML+='<span class="cross-mark remove-config"></span><a class="edit-config" id='+instance.instanceId+'>Edit</a>'
								authListDataHTML+='</div>';	
								console.log("authListDataHTML!!!" + JSON.stringify(listResultData));
							}
						});
						$("#instance-list-block").html(listDataHTML);
						$("#unauth-instance-list-block").html(authListDataHTML);
				  }else{
					$("#instance-list-block").html(listDataHTML);
					$("#unauth-instance-list-block").html(authListDataHTML);
				  }
				}
			});	
		}else{
			listDataHTML+='<hr class="instance-hr"><div class="large-12 medium-12 columns instance-background">';
			listDataHTML+='<div class="no-config-msg">You have no configurations. Click Add to set up one.</div></div>';
			$("#instance-list-block").html(listDataHTML);
		}
		
	}
}
var auth_url="applications";
var token_url="tokendetails/bitbucket";
var form_data_url="test.html";
var post_form_data_url="test.html";
var list_instances_url="test.html";
var update_form_data_url="test.html";
var delete_instance_url="deleteInstance";
var removeall_integration_instances_url="bitbucket/removeallinstances";
var disconnect_integration_url="disconnectintegration";
var get_app_token_url = "test.html";

var integration_id="";
var integration_token="";
var spark_token="";
var listResultData="";
var instanceData="";
var formData="";
var formAction="add";
var instanceId="";
var repo_modified=false;
var room_modified=false;
var repo_name_old="";
var room_id_old="";
var validateLink = false;
function generateUUID() {
    var d = new Date().getTime();
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        var r = (d + Math.random()*16)%16 | 0;
        d = Math.floor(d/16);
        return (c=='x' ? r : (r&0x3|0x8)).toString(16);
    });
    return uuid;
};
function getUnauth(){
	$('#authenticate-block').hide();
	$('.jira-data').hide();
	authenticationFlag = false;
	validateLink=true;
	$(".unauth").hide();
	$(".auth").show();
	loadJiraForm();
}
function expandSetup(){
	 $('#showSetup').hide();
	 $("#expand-close").removeClass("closearrow");
	 $("#expand-close").addClass("expandarrow");
	 $('.expandarrow').attr('title','expand');
}
function collapseSetup(){
	$("#expand-close").addClass("closearrow");
	$("#expand-close").removeClass("expandarrow");
	$('.closearrow').attr('title','close');
	$('#showSetup').show();
}
function validateIntegrationAppToken() {
	console.log("validating token....");
	if(appTokenExists&&!validateLink || appTokenExists&&validateLink){
		console.log("validateIntegrationAppToken tokenExits");
		loadJiraForm();
	}else if(!appTokenExists&&!validateLink){
		jiraListIntegrations();
	}else if(validateLink&&authenticationFlag){
		if(appTokenExists){
			loadJiraForm();
		}else{
			$('#zendesksubdomain').val('');
			expandSetup();
			$('#authenticate-block').show();
		}
	}
}

function objLength(obj){
	var i=0;
	for (var x in obj){
		if(obj.hasOwnProperty(x)){
			i++;
		}
	} 
	return i;
}
function addOrUpdateUnauthInstance(){
		console.log("un auth add!!!!");
		var selectedAllEvents = "";
		var res = $('form').serializeObject();		
		var has_empty=false;
		$('#notificationList input').each(function () {
			if ( ! $(this).val() ) {
				has_empty = true;
			}
		});
		selectedRoomName=$("#unauthrooms option:selected").text();
		var issueTypeEvents = "";
		room_id = $("#unauthrooms option:selected").val();;
		var statuses = $('form').serializeObject1();
		var statusObjects = [];
		  $.each(statuses, function(key, value) {
				if($.isArray(value)){
					for(var i=0; i<value.length; i++){
						if (value[i] === "" || value[i] === null || value[i]==undefined) {
						}else{
							statusObjects.push(value[i]);
						}
					}
				}else if (value === "" || value === null) {
						delete statuses[key];
					} else if (typeof(value) === "object") {
						statuses[key] = value;
				}
		})
		if ($.isArray(res.issuetype)) {
			var issueTypesArray = [];
				$.each(res.issuetype, function(index, value) {
					issueTypesArray.push(value);
				});
				if($.inArray('All', issueTypesArray)>-1){
					issueTypeEvents="All";
				}else{
					issueTypeEvents = res.issuetype;
				}
		}else{
			issueTypeEvents = res.issuetype;
		}
		saveJsonString = JSON.stringify(jsonData);
		var eventslength = $('input[name="events"]:checked').length;
		var typeslength = $('input[name="issuetype"]:checked').length;
		var statuslength = $('#notificationList').children().length;
		var issueStatuses =  statusObjects;
		var issueTypeNotifications = issueTypeEvents;
		
		if($('#unauthrooms').val()==0 || $('#unauthrooms').val()==null){
			alert("Please select Space.");
		} else if(typeslength==0){
			alert("Please select IssueTypes.");
		} else if(has_empty){
			alert("Please enter status change field value.");
		} else if(eventslength==0){
			alert("Please select atleast one event.");
		}else{
			$('.loading-second-block').html('Selected Room is '+ selectedRoomName);
			$('#loading-block').foundation('open');
			$.ajax({
				url: post_form_data_url,
				async: false,
				success: function(result){				
					$('#success-integration').foundation('open');
					$('#done-button').click(function() {
						$('#success-integration').foundation('close');
						$("#integration-form").hide();
						jiraListIntegrations();
						$("#integrations-block").show();
					});
				},
				error: function (error) {
					alert('error while saving data' + error);
				}
			});
		}
}
function addOrUpdateInstance() {
	authenticate = "success";
	$("#submit-button").text("Add Integration");
	var res = $('form').serializeObject();
	selectedRoomName=$("#rooms option:selected").text();
	displayName = $('#displayName').val();
	res = JSON.stringify($('form').serializeObject());
	console.log(res);
	localStorage.setItem("jiraFormData",res);
	var checkRes = false;
	var eventslength = $('input[name="events"]:checked').length;
	var typeslength = $('input[name="issuetype"]:checked').length;
	var statuslength = $('input[name="status"]:checked').length;
	if($('#private_message').is(':checked') || $('#rooms').val()!=0 ){
		checkRes = true;
	}
	if(!checkRes){
		alert("Please select Space/Private Message(only to me)");
	}else{
		if(eventslength==0&&typeslength==0&&statuslength==0){
			$('#same-configuration').foundation('open');
		}else if($('#projects').val()==0){
			alert("Please select projects.");
		}else if(typeslength==0){
			alert("Please select issue types.");
		}else if(statuslength==0){
			alert("Please select issue status.");
		}else if(eventslength==0){
			alert("Please select at least one event.");
		}else{
			$('.loading-second-block').html('Selected Room is '+ selectedRoomName);
			$('#loading-block').foundation('open');
			$.ajax({
				url: post_form_data_url,
				async: false,
				success: function(result){				
					$('#success-integration').foundation('open');
					$('#done-button').click(function() {
						$('#success-integration').foundation('close');
						$("#integration-form").hide();
						jiraListIntegrations();
						$("#integrations-block").show();
					});
				},
				error: function (error) {
					alert('error while saving data' + error);
				}
			});
		}
	}
	
}

 jsonData= {"zendeskdomain":"eidiko",
			"notifications":[{"name":"Ticket Created","id":"ticketcreated","checked":false,"status":true},{"name":"Updates to \"New\" tickets","id":"updatestonewticket","checked":false,"status":true},{"name":"Updates to \"Open\" tickets","id":"updatestoopenticket","checked":false,"status":true},{"name":"Updates to \"Pending\" tickets","id":"updatestopendingticket","checked":false,"status":true},{"name":"Updates to \"On-Hold\" tickets","id":"updatestoonholdtickets","checked":false,"status":false},{"name":"Updates to \"Solved\" tickets","id":"updatestosolvedtickets","checked":false,"status":true},{"name":"Ticket Closed","id":"ticketclosed","checked":false,"status":true}],
			"Rooms":[{"id":"room0","name":"Room0"},{"id":"room1","name":"Room1"},{"id":"wrongroom2","name":"wrongRoom2"},{"id":"room3","name":"Room3"}],
			"Projects":[{"id":"project0","name":"project0"},{"id":"project1","name":"project1"},{"id":"project2","name":"project2"}],
			"displayName":"","profiles":[{"id":"profile1","displayName":"abc"}]
		   };
		   
authData = [{"instanceId":26728,"integrationId":"Y2lzY29zcGFyazovL3VzL0FQUExJQ0FUSU9OL0M4MDhhY2YzNTA1NjFiNjg5NmNkYWJhOWEzMjg5MDYwYWU2Y2E5YWRmODZmNDVlNGZlMzQ3ZTgxNDY4NWQ2ODA3","userId":"Y2lzY29zcGFyazovL3VzL1BFT1BMRS80ZDNlZmY2MS03NWM0LTQ2YmYtOTIxZi02YWZiMzNmMGZjYTg","updatedDate":"2017-05-11T04:48:41","messageFormat":"JIRA Bot :Hello...User","createdDate":"2017-05-11T04:48:41","status":"ACTIVE","channelId":"room2","configJson":"{\"displayName\":\"config2\", \"oauth\":\"true\",\"webhookurl\":\"https://cisco-spark-integration-management-new-dev.cloudhub.io/api/hooks/127e8f70-3605-11e7-8e18-0a8370b2eac2\",\"notifications\":{\"issuesStatus\":[{\"from\":\"*\",\"to\":\"To Do\"},{\"from\":\"*\",\"to\":\"In Progress\"},{\"from\":\"*\",\"to\":\"Resolved\"},{\"from\":\"*\",\"to\":\"Done\"}],\"comments\":[\"newcomment\",\"restricted-comments\",\"description\"],\"isuuesType\":\"bug\"}}","instanceUuid":"127e8f70-3605-11e7-8e18-0a8370b2eac2"}]
listResultData = [{"instanceId":26727,"integrationId":"Y2lzY29zcGFyazovL3VzL0FQUExJQ0FUSU9OL0M4MDhhY2YzNTA1NjFiNjg5NmNkYWJhOWEzMjg5MDYwYWU2Y2E5YWRmODZmNDVlNGZlMzQ3ZTgxNDY4NWQ2ODA3","userId":"Y2lzY29zcGFyazovL3VzL1BFT1BMRS80ZDNlZmY2MS03NWM0LTQ2YmYtOTIxZi02YWZiMzNmMGZjYTg","updatedDate":"2017-05-11T04:42:37","messageFormat":"JIRA Bot :Hello...User","createdDate":"2017-05-11T04:42:37","status":"ACTIVE","channelId":"room1","configJson":"{\"displayName\":\"config1\",\"oauth\":\"false\",\"webhookurl\":\"https://cisco-spark-integration-management-new-dev.cloudhub.io/api/hooks/31e06c90-3604-11e7-8e18-0a8370b2eac2\",\"notifications\":{\"issuesStatus\":[{\"from\":\"*\",\"to\":\"To Do\"},{\"from\":\"*\",\"to\":\"In Progress\"},{\"from\":\"*\",\"to\":\"Resolved\"},{\"from\":\"*\",\"to\":\"Done\"}],\"comments\":[\"newcomment\",\"priority\"],\"isuuesType\":\"bug\"}}","instanceUuid":"31e06c90-3604-11e7-8e18-0a8370b2eac2"},{"instanceId":26728,"integrationId":"Y2lzY29zcGFyazovL3VzL0FQUExJQ0FUSU9OL0M4MDhhY2YzNTA1NjFiNjg5NmNkYWJhOWEzMjg5MDYwYWU2Y2E5YWRmODZmNDVlNGZlMzQ3ZTgxNDY4NWQ2ODA3","userId":"Y2lzY29zcGFyazovL3VzL1BFT1BMRS80ZDNlZmY2MS03NWM0LTQ2YmYtOTIxZi02YWZiMzNmMGZjYTg","updatedDate":"2017-05-11T04:48:41","messageFormat":"JIRA Bot :Hello...User","createdDate":"2017-05-11T04:48:41","status":"ACTIVE","channelId":"room2","configJson":"{\"displayName\":\"config2\", \"oauth\":\"true\",\"webhookurl\":\"https://cisco-spark-integration-management-new-dev.cloudhub.io/api/hooks/127e8f70-3605-11e7-8e18-0a8370b2eac2\",\"notifications\":{\"issuesStatus\":[{\"from\":\"*\",\"to\":\"To Do\"},{\"from\":\"*\",\"to\":\"In Progress\"},{\"from\":\"*\",\"to\":\"Resolved\"},{\"from\":\"*\",\"to\":\"Done\"}],\"comments\":[\"newcomment\",\"restricted-comments\",\"description\"],\"isuuesType\":\"bug\"}}","instanceUuid":"127e8f70-3605-11e7-8e18-0a8370b2eac2"}];


	function  fillNotificationList(list){
		console.log("in fillnotification!!!!");
		if(authenticationFlag){
			$("#authNotificationList").html('<div></div>');
			$.each(list, function(index, obj){
				var insertPosition = $("#authNotificationList > div").length;
				count=insertPosition-1;
				$("#authNotificationList > div:nth-child(" + (insertPosition) + ")").after('<div class="large-10 medium-12 columns staticCount" id="field_'+count+'" style="margin-bottom: 10px"><div class="large-5 medium-4 columns left status-fields"><input type="text" id="from_'+count+'" value="'+obj.from+'" name="notifications['+count+'][from]"></input></div><span class="towards-arrow" title="To">&nbsp;</span><div class="large-5 medium-4 columns left status-fields">	<input type="text" id="to_'+count+'" value="'+obj.to+'" name="notifications['+count+'][to]"></input></div><span class="remove-status" onclick="javascript:removeField('+count+');return false;" title="Remove">&nbsp;</span></div>');
			});
		}else{
			$("#notificationList").html('<div></div>');
			$.each(list, function(index, obj){
				var insertPosition = $("#notificationList > div").length;
				count=insertPosition-1;
				$("#notificationList > div:nth-child(" + (insertPosition) + ")").after('<div class="large-10 medium-12 columns staticCount" id="field_'+count+'" style="margin-bottom: 10px"><div class="large-5 medium-4 columns left status-fields"><input type="text" id="from_'+count+'" value="'+obj.from+'" name="notifications['+count+'][from]"></input></div><span class="towards-arrow" title="To">&nbsp;</span><div class="large-5 medium-4 columns left status-fields">	<input type="text" id="to_'+count+'" value="'+obj.to+'" name="notifications['+count+'][to]"></input></div><span class="remove-status" onclick="javascript:removeField('+count+');return false;" title="Remove">&nbsp;</span></div>');
			});
		}
		
	 }
	 function testCoo(){
		if(authenticationFlag){
			divCount = $('#authNotificationList').find('div').length;
			if($('#authNotificationList').find('div').length>3){
				divCount = divCount-3;
			}
		}else{
			divCount = $('#notificationList').find('div').length;
			if($('#notificationList').find('div').length>3){
				divCount = divCount-3;
			}
		}
	 }
	function removeField(id){
		if(authenticationFlag){
			var length = $('#authNotificationList').children().length;
			if(length>2){$('#field_'+id).remove();}else{alert("Please give at least one status.");}
			var c = 0,inputCount=-1;
			$('#authNotificationList').find('input:text').each(function() {
				inputCount++;
				if(inputCount%2 == 0){
					$(this).attr('name','notifications['+(c)+'][from]');
					$(this).attr('id','from_'+c);	
				}
				if(inputCount%2 == 1){
					$(this).attr('name','notifications['+(c)+'][to]');
					$(this).attr('id','to_'+c);
				}
				if(inputCount%2 == 1){
					c++;
				} 
			});
		}else{
			var length = $('#notificationList').children().length;
			if(length>2){$('#field_'+id).remove();}else{alert("Please give at least one status.");}
			var c = 0,inputCount=-1;
			$('#notificationList').find('input:text').each(function() {
				inputCount++;
				if(inputCount%2 == 0){
					$(this).attr('name','notifications['+(c)+'][from]');
					$(this).attr('id','from_'+c);	
				}
				if(inputCount%2 == 1){
					$(this).attr('name','notifications['+(c)+'][to]');
					$(this).attr('id','to_'+c);
				}
				if(inputCount%2 == 1){
					c++;
				} 
			});
		}
		
	}
	function changeToArray(obj){
		if( typeof obj === 'string' ) {
			obj = [ obj ];
			return obj;
		}else{return obj;}
	}
function loadJiraForm(){
	console.log("in loadJiraForm!!!");
	$('#integrations-block').hide();
	$("#integration-form").show();
	$('.jira-auth-btn').hide();
	$("#form").trigger("reset");
	$("#rooms").prop("disabled", false);
	statusJSON = '{"statuses": [{"from": "*","to": "To Do"}, {"from": "*","to": "In Progress"}, {"from": "*","to": "Resolved"}, {"from": "*","to": "Done"}]}';
			var typeVal = JSON.parse(statusJSON);
			if(formAction!="update"){
				console.log("in not update!!!!!!");
				fillNotificationList(changeToArray(typeVal.statuses));
			}else{
				console.log("in update!!!!!!");
				if(configStatusJson!=undefined){
					if(configStatusJson[0].hasOwnProperty("from")){
						fillNotificationList(changeToArray(editStatusJson.statuses));
					}else{
						fillNotificationList(changeToArray(typeVal.statuses));
					}
				}else{
						fillNotificationList(changeToArray(typeVal.statuses));
				}
				var removeEmptyDivs = [];
				$('#notificationList').find('div').each(function() {
					if($('#notificationList').find('div').is(':empty')){
						removeEmptyDivs.push(this.id);
					}
				});
			}
			resize();
			console.log("authentication Flag value!!!" + authenticationFlag);
	if(authenticationFlag){
		console.log("loadForm authenticationFlag");
		$('#projects')[0].options.length = 4;
		appTokenExists = true;
		$(".jira-domain-block").hide();
		$(".jira-unauth").hide();
		$(".jira-auth").show();
		$(".auth").hide();
		$(".unauth").hide();
		$('.unauth-config-info').hide();
		$("#unauth-showConfig").hide();
		$.ajax({
			url: form_data_url,
			async: false,
			success: function(result){
				$('#integrations-block').hide();
				$('#authenticate-block').hide();
				$('#integration-form').show();	
				$('#zendeskdomain').val(protocol+localStorage.getItem("jiraBaseURL",jiraBaseURL)+domain);
				$('.zendeskdomain-text').html(protocol+localStorage.getItem("jiraBaseURL",jiraBaseURL)+domain);
				
			},
			error: function (error) {
				alert('error while loading the form data' + error);
				$('#integration-form').hide();
				$('#integrations-block').show();				
			}
		});
			var rooms = jsonData.Rooms;
			$('#rooms')[0].options.length = 1;
			$.each(rooms, function(id,obj){
				console.log("obj.id!!!" + obj.id);
				$("#rooms").append($('<option>').text(obj.name).attr('value',obj.id));
			}); 
			console.log("selected_room_id!!!" + selected_room_id);
			$("#rooms").val(selected_room_id);
			$('#select2-rooms-container').html($("#rooms option:selected").text());
			selected_room_id="0";
	}else{
			console.log("loadForm not authenticationFlag");
			$(".jira-domain-block").hide();
			$(".jira-auth").hide();
			$(".jira-unauth").show();
			console.log("formAction!!!!!!" + formAction);
			$(".auth").hide();
			$(".unauth").hide();
			var rooms =  "";
			var rooms = jsonData.Rooms;
			$('#unauthrooms')[0].options.length = 1;
			$.each(rooms, function(id,obj){
				console.log("obj.id!!!" + obj.id);
				$("#unauthrooms").append($('<option>').text(obj.name).attr('value',obj.id));
			}); 
			console.log("selected_room_id!!!" + selected_room_id);
			$("#unauthrooms").val(selected_room_id);
			$('#select2-rooms-container').html($("#unauthrooms option:selected").text());
			selected_room_id="0";
	}

}
var	authenticate = "";

$(document).ready(function(){
	$(document).foundation();
	$('#integration-form').hide();
	$("#rooms").on('change',function(){
		room_modified=true;
		console.log("room_modified....");
	});		
	$("#zendesk-icon").attr("src", integration_app_icon_url);
	$("#spark-icon").attr("src", spark_icon_url);	
	$.fn.serializeObject = function() {
		var o = {};
		var a = this.serializeArray();
		$.each(a, function() {
			if (o[this.name] !== undefined) {
				if (!o[this.name].push) {
					o[this.name] = [o[this.name]];
				}
				o[this.name].push(this.value || '');
			} else {
				console.log(this);
				o[this.name] = this.value || '';
			}
		});
		return o;
	};
	$("#submit-button").click(function(e){
		e.preventDefault();
		addOrUpdateInstance();
	});
	$("#unauth-submit-button").click(function(e){
		e.preventDefault();
		addOrUpdateUnauthInstance();
	});
	$("#cancel-button").click(function (e){
		console.log("in cancel button!!!!");
		e.preventDefault();			
		formAction ="list";
		$('.bot-err-msg').hide();
		$('#integration-form').hide();
		jiraListIntegrations();
		$(".unauth-config-block").show();
	});
	$("#unauth-cancel-button").click(function (e){
		console.log("in unauth cancel button!!!!");
		e.preventDefault();			
		$('#integration-form').hide();
		$(".unauth-config-block").show();
		jiraListIntegrations();
	});
	$('#jira #add-config').click(function(){
	    console.log("click on add button!!!!");
		formAction="add";
		if(validateLink){
			console.log("add btn validateLink true");
			if(appTokenExists){
				console.log("add btn validateLink true and appTokenExists true");
				loadJiraForm();
			}else{
				console.log("add btn validateLink true and appTokenExists false");
				$("#authenticate-block").show();
			}
		}else{
			console.log("add btn validateLink false");
			loadJiraForm();
		}
		/*authenticate = "success";
		$("#authenticate-block").hide();
		formAction = "add";
		$('.issuestatus div.ms-options-wrap > button').html("Select Statuses");
		$('.issuetypes div.ms-options-wrap > button').html("Select Types");
		if(authenticate == "success"){
			console.log("in add button");
			loadJiraForm();
		}else{
			$('#integrations-block').hide();	
			$('#authenticate-block').show();
			$('#integration-form').show();
		}	*/
		$("#expand-close-config").removeClass("expandarrow");
		$("#expand-close-config").addClass("closearrow");
		$('.closearrow').attr('title','close');
		$(".config-info").hide();
		$("#showConfig").hide();			
		$("#config-label").html('You have to be a JIRA admin to add this configuration. Please follow the below steps to add this configuration. You can add/edit/delete multiple configurations at anytime.');
	});
	$('#get-authentication').click(function(e){
	   e.preventDefault();
	   if($('#zendesksubdomain').val()!="" && $('#zendesksubdomain').val()!="dummy" && $('#zendesksubdomain').val()!="userbaseurl") {
			UUID = "";
			$('#sharedSecret').val("");
			UUID = generateUUID();
			$('#sharedSecret').val(UUID);
			$('.second-step').show();
			$('.instructions-config-info').show();
			$("#showSetup").show();
			collapseAuthInstructions();
			$('.jira-auth-btn').show();
	   }else if($('#zendesksubdomain').val()=="dummy"){
			console.log("dummy url !!!");
			alert("Please enter valid jira baseurl");
	   }else if($('#zendesksubdomain').val()=="userbaseurl"){
			$('.second-step').show();
			$('.instructions-config-info').show();
			$("#showSetup").show();
			collapseAuthInstructions();
			$('.jira-auth-btn').show();
	   }else{
			alert("Please enter your jira baseurl");
	   }
	});
	$('#authenticate-btn').click(function(e){
		   jiraBaseURL = $('#zendesksubdomain').val();
		   console.log("entered baseurl !!!" + jiraBaseURL);
		   localStorage.setItem("jiraBaseURL",jiraBaseURL);
		   checkBaseURL();
	});
	$("#rooms").on('change', function(e){
		if($('#rooms').val()!=0&&$('#rooms').val()!='wrongroom2'){
			$('.bot-err-msg').hide();
		}
	});
	$('#add-bot-button').click(function(e){
		e.preventDefault();
		$('.bot-err-msg').hide();
		var checkRes = false;
		if($('#private_message').is(':checked') || $('#rooms').val()!=0 ){
			checkRes = true;
		}
		if(!checkRes){
			alert("Please select Space/Private Message(only to me)");
		}else if($("#rooms").val()!=0&&$("#rooms").val()=="wrongroom2"){
			$('.bot-err-msg').show();
		}else{
			$('.bot-err-msg').hide();
			alert("Bot added successfully.");
		}
	});
	$('#add_status').click(function(e){
		e.preventDefault();
		dynamicStatus=[];
		calculateDivIds();
		insertAtIndex($("#notificationList > div").length);
		resize();
	});
	$(document).on("click", ".edit-config" , function() {
		instanceId=this.id;
		console.log("instance id!!!!!!!" + this.id);
		$.each(listResultData,function(index,value){
			if(value["instanceId"]==instanceId) {
			    console.log("instance id matched!!!!" + instanceId);
				instanceData=value;
			}
		});
		formAction="update";
		var config=JSON.parse(instanceData.configJson);
		console.log("config.oauth!!!!" + config.oauth);
		if(config.oauth=="false"){
			authenticationFlag = false;
			console.log("edit in unauth!!!!!!");
			$('#select2-rooms-container').html('Please Select');
			var issueStatusArray = [];
			var issueTypesArray = [];
			allEventsArray = [];
			var typesArray = [];
			var otherEventsArray = [];
			var issueSelectedText = "";
			var issueTypeText = "";	
			$('.custom-event-remove').remove();
			$('.otherissuetypes').remove();
			$('#unauth-issuetypes').multiselect('reload');
		 	$('.unauthissuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('name', 'unauthissuetype');
		    $('.unauthissuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('class', 'unauthissuetype');
		    $('.unauthissuetypes div.ms-options > ul > li > ul > li input[value="All"]').attr('class', 'unauthissuetypeall');
			$('.otherevent-disable').prop("disabled",false);
			$('.otherevent-custom-disable').prop("disabled",false);
			$('.otherevent-disable').prop("checked",false);
			$('.otherevent-custom-disable').prop("checked",false);
			
			$("#expand-close").removeClass("closearrow");
			$("#expand-close").addClass("expandarrow");
			$('.expandarrow').attr('title','expand');
			$("#showSetup").hide();
			$("#unatuh-expand-close-config").removeClass("closearrow");
			$("#unauth-expand-close-config").addClass("expandarrow");
			$('.expandarrow').attr('title','expand');
			$(".unatuh-config-info").show();
			$("#unauth-showConfig").hide();			
			$("#config-label").html('Steps you had executed to add this configuration. View for reference, if needed. Otherwise, steps need not be executed again.');
			room_modified=false;
			$("#submit-button").text("Save");
			instanceId=this.id;
			$("input[name=events]").each( function () {
			   allEventsArray.push($(this).val());
			});
			$.each(listResultData,function(index,value){
				if(value["instanceId"]==instanceId) {
					instanceData=value;
				}
			});
			selected_room_id=instanceData.channelId;
			room_id_old = instanceData.channelId;
			var config=JSON.parse(instanceData.configJson);
			var notifications=config.notifications;
			editStatusJson["statuses"] = notifications.issuesStatus;
			configStatusJson = notifications.issuesStatus;
			loadJiraForm();
			$("#webhookURL").val(config.webhookurl);
			$('#displayName').val(config.displayName);
			$('#instanceid').val(instanceId);
			instanceUuid = instanceData.instanceUuid;
			var issuetype = notifications.isuuesType;
			
			var comments = notifications.comments;
			if(notifications.hasOwnProperty("comments")){
				otherEventSelectedValues = [];
				if($.isArray(comments)) {
					$.each(comments,function(index,value){
						otherEventSelectedValues.push(value);
						if(value=="all"){
							   allEventStatus = true;
							   isSprintBoard = true;
							   $('.otherevent-disable').prop("disabled",true);
							   $('.otherevent-custom-disable').prop("disabled",true);
							   $('.otherevent-disable').prop("checked",false);
							   $('.otherevent-custom-disable').prop("checked",false);
							   $("input[type=checkbox][value="+value+"][name=events]").prop("checked",true);
						}else if(value!="user"&& value!="project"){
							 $("input[type=checkbox][value="+value+"][name=events]").prop("checked",true);
							if(allEventsArray.indexOf(value)==-1){
								otherEventsArray.push(value);
							}
						}
					});
				} else {
						otherEventSelectedValues.push(comments);
						if(comments=="all"){
							allEventStatus = true;
							isSprintBoard = true;
						  $('.otherevent-disable').prop("disabled",true);
						  $('.otherevent-custom-disable').prop("disabled",true);
						  $("input[type=checkbox][value="+comments+"][name=events]").prop("checked",true);
						  
						}else if(comments!="user"&&comments!="project"){
							 $("input[type=checkbox][value="+comments+"][name=events]").prop("checked",true);
							if(allEventsArray.indexOf(comments)==-1){
								otherEventsArray.push(comments);
							}
					   }
				}	
			}
			console.log("issuetype!!!" + issuetype);
			if ($.isArray(issuetype)) {
				$.each(issuetype, function(index, value) {
					issueTypesArray.push(value);
					if($("input[type=checkbox][value]")==value)
						$("input[type=checkbox][value="+ value + "]").prop("checked", true);
					else typesArray.push(value);
				});
			} else {
				issueTypesArray.push(issuetype);
				if(issuetype=="All"){
					$("input[type=checkbox][value="+ issuetype+ "]").prop("checked", true);
					$(".unauthissuetype").prop('checked',true);
				}else{
					<!--if($("input[type=checkbox][value]")==issuetype){-->
						$("input[type=checkbox][value="+ issuetype + "]").prop("checked", true);
						
					<!--}else{ typesArray.push(issuetype);console.log("value not matched with check box!!!");}-->
				}
			}
			if ($.isArray(typesArray)) {
				$.each(typesArray, function(index, value) {
					var checkIssueType = value.replace(/\s/g, "");
				    checkIssueType = checkIssueType.toLowerCase();
					$("#unauth-issue-types-options").append($('<option>').attr('class','otherissuetypes').text(value).attr('value',checkIssueType).prop('selected', true));
					$('#unauth-issuetypes').multiselect('reload');
					$('.unauthissuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('name', 'unauthissuetype');
					$('.unauthissuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('class', 'unauthissuetype');
					$('.unauthissuetypes div.ms-options > ul > li > ul > li input[value="All"]').attr('class', 'unauthissuetypeall');
				});
			}else{
					var checkIssueType = typesArray.replace(/\s/g, "");
				    checkIssueType = checkIssueType.toLowerCase();
				  $("#unauth-issue-types-options").append($('<option otherissuetypes>').attr('class','otherissuetypes').text(typesArray).attr('value',checkIssueType).prop('selected', true));
					$('#unauth-issuetypes').multiselect('reload');
					$('.unauthissuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('name', 'unauthissuetype');
					$('.unauthissuetypes div.ms-options > ul > li > ul > li').find(':checkbox').attr('class', 'unauthissuetype');
					$('.unauthissuetypes div.ms-options > ul > li > ul > li input[value="All"]').attr('class', 'unauthissuetypeall');
			}
			issueTypeText = issueTypesArray.join(',');	
			console.log("issueTypeText!!!" + issueTypeText);
			$('.unauthissuetypes div.ms-options-wrap > button').html(issueTypeText);
			if ($.isArray(otherEventsArray)) {
				$.each(otherEventsArray, function(index, value) {
					var otherEventValue = value.replace(/\s/g, "");
						otherEventValue = otherEventValue.toLowerCase();
					var length = $('#other_notifications div').last().parent().children().length;
						if(length==1){
							$('#other_notifications div').last().parent().append('<div class="large-3 medium-4 columns checkbox"><input name="events" id="'+otherEventValue+'" value="'+otherEventValue+'" type="checkbox" class="otherevent-custom-disable"><label for="'+otherEventValue+'">'+value+'</label></div>');
							$("input[type=checkbox][value="+otherEventValue+"][name=events]").prop("checked",true);
						}else{
							$('#other_notifications').append('<div class="large-12 medium-12 columns custom-event-remove"><div class="large-3 medium-4 columns checkbox"><input name="events" id="'+otherEventValue+'" value="'+otherEventValue+'" type="checkbox" class="otherevent-custom-disable"><label for="'+otherEventValue+'">'+value+'</label></div></div>');
							$("input[type=checkbox][value="+otherEventValue+"][name=events]").prop("checked",true);
						}
				});
			}else{
				var length = $('#other_notifications div').last().parent().children().length;
				var otherEventValue = otherEventsArray.replace(/\s/g, "");
					otherEventValue = otherEventValue.toLowerCase();
					if(length==1){
						$('#other_notifications div').last().parent().append('<div class="large-3 medium-4 columns checkbox"><input name="events" id="'+otherEventValue+'" value="'+otherEventValue+'" type="checkbox" class="otherevent-custom-disable"><label for="'+otherEventValue+'">'+otherEventsArray+'</label></div>');
						$("input[type=checkbox][value="+otherEventValue+"][name=events]").prop("checked",true);
					}else{
						$('#other_notifications').append('<div class="large-12 medium-12 columns custom-event-remove"><div class="large-3 medium-4 columns checkbox"><input name="events" id="'+otherEventValue+'" value="'+otherEventValue+'" type="checkbox" class="otherevent-custom-disable"><label for="'+otherEventValue+'">'+otherEventsArray+'</label></div></div>');
						$("input[type=checkbox][value="+otherEventValue+"][name=events]").prop("checked",true);
					}
			}
			resize();
		}else{
			authenticationFlag = true;
			console.log("edit jira auth!!!");
		/*	var issueStatusArray = [];
			var issueTypesArray = [];
			var issueSelectedText = "";
			var issueTypeText = "";	*/
			formAction="update";
			/*$("#expand-close-config").removeClass("closearrow");
			$("#expand-close-config").addClass("expandarrow");
			$('.expandarrow').attr('title','expand');
			$(".config-info").show();
			$("#showConfig").hide();			
			$("#config-label").html('Steps you had executed to add this configuration. View for reference, if needed. Otherwise, steps need not be executed again.');
			room_modified=false;*/
			$("#submit-button").text("Save");
			
			//formData = localStorage.getItem("jiraFormData");
			//var json = JSON.parse(formData);
			selected_room_id=instanceData.channelId;
			room_id_old = instanceData.channelId;
			var config=JSON.parse(instanceData.configJson);
			//$('#select2-rooms-container').html($("#rooms option:selected").text());
			$('#displayName').val(config.displayName);
			var notifications=config.notifications;
			editStatusJson["statuses"] = notifications.issuesStatus;
			configStatusJson = notifications.issuesStatus;
			loadJiraForm();
			/*var events = json.events;
			var status = json.status;
			var issuetype = json.issuetype;
			if($.isArray(events)) {
				$.each(events,function(index,value){
					$("input[type=checkbox][value="+value+"]").prop("checked",true);
				});
			} else {
				$("input[type=checkbox][value="+events+"]").prop("checked",true);
			}
			if ($.isArray(status)) {
				$.each(status, function(index, value) {
					issueStatusArray.push(value);
					$("input[type=checkbox][value="+ value + "]").prop("checked", true);	
				});
			} else {
				issueStatusArray.push(status);
				$("input[type=checkbox][value="+ status+ "]").prop("checked", true);
			}
			issueSelectedText = issueStatusArray.join(',');
			if ($.isArray(issuetype)) {
				
				$.each(issuetype, function(index, value) {
					issueTypesArray.push(value);
					$("input[type=checkbox][value="+ value + "]").prop("checked", true);
				});
			} else {
				issueTypesArray.push(issuetype);
				if(issuetype=="All"){
					issueSelectedText = "All";
					$("input[type=checkbox][value="+ issuetype+ "]").prop("checked", true);
					$(".issuetype").prop('checked',true);
				}else{
					$("input[type=checkbox][value="+ issuetype+ "]").prop("checked", true);
				}
			}
			issueTypeText = issueTypesArray.join(',');
			$('.issuestatus div.ms-options-wrap > button').html(issueSelectedText);
			$('.issuetypes div.ms-options-wrap > button').html(issueTypeText);*/
		}
	});

	$(document).on("click", "#instance-list-block .remove-config" , function() {
			console.log("on click remove");
			$("#displayName-label").html(displayName);
			$("#addedon-label").html("Added on: 27th Jul 2016");
			$("#remove-msg").html("Are you sure you  want to remove integration from "+selectedRoomName+" room?");	
			formAction="remove";
			$('#remove-integration-btn').text("Remove");			
	});
	$(document).on("click", "#remove-all-config" , function() {
		console.log("test remove all");
		document.getElementById('remove-msg').innerHTML="Are you Sure you  want to remove all the integration instances?";
		formAction="removeAll";			
		resize();
	});
	$('#cancel-remove-integration').click(function(e){
		e.preventDefault();
		$('#remove-integration-popup').foundation('close');
	});		
	$('#remove-integration-btn').click(function(e){
		e.preventDefault();
		$('#remove-integration-popup').foundation('close');
		if(formAction=="removeAll") {
			removeAllIntegrationInstances("remove");
		} else { 
			removeIntegrationInstance();
		}
	});	
console.log("in document ready second()!!!!!!");
});
function insertAtIndex(i) {
	var count = addElementsCount;
	$("#notificationList > div:nth-child(" + (i) + ")").after('<div class="large-10 medium-12 columns dynamicCount" id="field_'+count+'" style="margin-bottom: 10px"><div class="large-5 medium-4 columns left status-fields"><input type="text" id="from_'+count+'" value="" name="notifications['+count+'][from]"></input></div><span class="towards-arrow" title="To">&nbsp;</span><div class="large-5 medium-4 columns left status-fields">	<input type="text" id="to_'+count+'" value="" name="notifications['+count+'][to]"></input></div><span class="remove-status" onclick="javascript:removeField('+count+');testCoo();return false;" title="Remove">&nbsp;</span></div>');
}
function checkBaseURL(){
	urlResponse = true;
	 if(urlResponse){
		loadJiraForm();
		 $("#integration-form").show();
	}else{
		collapseSetup();
	}
}
function removeIntegrationInstance(instanceId) {
	$('.loading-second-block').html('Removing integration for the room '+ selectedRoomName);
	$.ajax({
		url:'test.html',
		success: function(result){		
			console.log("removeIntegrationInstance");
			
			$('#instance-list-block').hide();
			jiraListIntegrations();
		},
		error: function (error) {
			$('#loading-block').foundation('close');
			console.log('error while removing integration instance details..' + error);
			alert('Some problem occured, Pleaase try after some time');
		}
	});
	$('.loading-second-block').html('');
}
</script>
</head>
<body>
	<div class="spark-marketplace">
		<h1>DEV</h1>  <br>
		<div class="large-12 medium-12 columns">
			<div class="large-12 medium-12 columns" >
				<div class="large-2 medium-2 columns" ><label><b>Integration App</b></label></div>						
				<div class="large-10 medium-10 columns" >
				<select name="int_id"  id="intId" class="dropdown">
					<option value="Y2lzY29zcGFyazovL3VzL0FQUExJQ0FUSU9OL0M4MDhhY2YzNTA1NjFiNjg5NmNkYWJhOWEzMjg5MDYwYWU2Y2E5YWRmODZmNDVlNGZlMzQ3ZTgxNDY4NWQ2ODA3">JIRA</option>
				</select>
				<!--<input type="text" name="int_id" id="intId" value="1" placeholder="Id">-->
				</div>
			</div>
			<div class="large-12 medium-12 columns" >
				<div class="large-2 medium-2 columns" ><label><b>User ID</b></label></div>
				<div class="large-10 medium-10 columns">
					<select name="userid"  id="token" class="dropdown">
					<!-- <option value="Y2lzY29zcGFyazovL3VzL1BFT1BMRS8yYTA0YzVkMy0yNGJjLTQ1ZWItYmQzYS05ZDU1OGRmMmZhMjI">Surender</option> -->
					<option value="Y2lzY29zcGFyazovL3VzL1BFT1BMRS80ZDNlZmY2MS03NWM0LTQ2YmYtOTIxZi02YWZiMzNmMGZjYTg">Satya</option>
				</select>
				</div>
			</div>
			<div class="large-12 medium-12 columns" >
				<div class="large-2 medium-2 columns" >
					<label><b>Action</b></label>
				</div>
				<div class="large-10 medium-10 columns" >
					<!--<input type="text" name="action" id="action" value="CONNECT">-->
					<select name="action"  id="action" class="dropdown">
						<option value="LIST">LIST</option>
						<option value="CONNECT">CONNECT</option>
						<option value="DISCONNECT">DISCONNECT</option>
					</select>
				</div>
			</div>
		</div>

		<div class="large-8 medium-8 columns"><br>
			<button class="button" id="action-add-config">Submit</button>
		</div>
	</div>
	<div class="iframe">
		<div class="integration-app" id="jira"><br>
			<div id="loading-block" class="reveal" data-reveal data-options="closeOnClick:false;closeOnEsc:false;">
				<div class="loading"><img class="spark-icon" src="" alt="....."></div>
				<div class="loading-div-background">
					<div class="loading-first-block">Please wait just a moment while your app is loading</div>
					<div class="loading-second-block">name and space name</div>
					<div class="loading-bar"><div class="loading-background"></div>	</div>
				</div>
			</div>
			<div id="list-loading-block" class="reveal" data-reveal data-options="closeOnClick:false;closeOnEsc:false;">
				<div class="loading"><img class="spark-icon" src="" alt="....."></div>
				<div class="loading-div-background">
					<div class="loading-first-block">Please wait...</div>
					<div class="loading-second-block"></div>
					<div class="loading-bar"><div class="loading-background"></div>	</div>
				</div>
			</div>
			<div id="success-integration" class="reveal" data-reveal data-options="closeOnClick:false;closeOnEsc:false;">
				<div class="success-loading">
					<img class="spark-icon" src="" alt=".....">
				</div>
				<div class="well-done-text">Well done!</div>
				<div class="success-integration-first-block">Your configuration has been set up. Ensure that you have followed any additional instructions provided.</div>
				<div class="large-5 medium-5 columns buttons-block">
					<div class="success-integration-second-block">
						<!--<button class="button" id="room-button">Go to
							Content Testing Space</button>-->
						<button class="secondary button" id="done-button">Done</button>
					</div>
				</div>
			</div>
			<div class="reveal" id="remove-integration-popup" data-reveal data-options="closeOnClick:false;closeOnEsc:false;">
				<div class="large-12 columns desktop-block">			    
					<div class="row">
						<div class="large-2 medium-2 columns"><img alt="" id="jira-icon" src=""/></div>
						<div class="large-6 medium-6 columns" style="float:left;">
							<label id="displayName-label"></label>
							<label id="addedon-label"></label>
						</div>
					</div><br>
					<div class="msg-labels"><label id="remove-msg"></label> <label id="remove-auth"></label></div>				
					<button class="close-button" data-close aria-label="Close modal" type="button">
						<span aria-hidden="true">&times;</span>
					</button><br><br>
					<button class="button remove-integration-btn" id="remove-integration-btn" style="float:right">Remove</button>
				</div>
				<div class="large-12 columns mobile-block">	
					<div class="msg-labels"><label id="remove-msg-mobile"></label> <label id="remove-auth-mobile"></label></div>				
					<div class="option-buttons remove-integration-buttons">
						<label class="remove-popup-cancel"> 
							<a href="#" id="cancel-remove-integration">cancel</a>
						</label>
						<label class="remove-popup-remove">
							<a href="#" id="remove-integration-btn-mobile" class="remove-integration-btn">remove</a>
						</label>
					</div>
				</div>
			</div>
			<div id="same-configuration" class="reveal" data-reveal data-options="closeOnClick:false;closeOnEsc:false;">
				<div class="same-config-text">Are you sure you want to configure only Bot to your Space?</div>
				<div class="large-5 medium-5 columns buttons-block">
					<button class="secondary button same-config-yes">Yes</button>
					<button class="secondary button same-config-no">No</button>
				</div>
			</div>
			<div class="jira-data" style="display:none;">
				<p>You can set up this integration to work for on-prem and cloud version of JIRA</p>
				<p>You have to be a JIRA admin to set up this Integration</p>
				<p>You can set up multiple configurations for all standard JIRA issue types like EPIC, Story, Task, Bug, etc to different Cisco Spark spaces</p>
				<p>You can add, edit or delete any configuration at anytime</p>
			</div><br><br>
			<div class="jira-links">
				<p  class="auth" style="display:none;">Click <a href="#" class="auth-link">here</a> to add a JIRA Auth configuration.</p>
				<p class="unauth" style="display:none;">Click <a href="#" class="unauth-link">here</a> to add an unauthed mode or JIRA configuration.</p>
			</div>
			<div class="jira-add-config" style="display:none;">
				<div class="jira-add-config-text"><p>Click add to create a JIRA configuration.</p></div>
				<div class="jira-add-config-btn"><button class="secondary button" id="add-config">Add</button></div>
			</div>
			<div class="integrations" id="integrations-block">
				<div id="instance-loading-block" class="row instance-loading-block" style="display: none;">
					<div class="instances-loading">&nbsp;</div>
					<div class="instances-loading-text"></div>
				</div>
				<div id="home" class="home">
					<div class="row add-config-block">
						<div class="large-12 medium-12 columns">							
							<div class="large-6 medium-6 columns config-name"><label>JIRA Unauthorized configurations</label></div>
							<!--<div class="large-6 medium-6 columns">
								<button class="remove-all-btn" data-open="remove-integration-popup" id="remove-all-config">Remove All</button>
								<button class="secondary button" id="add-config">Add</button>
							</div>-->
						</div>
					</div>
					<div id="instance-list-block" class="row instance-list-block"></div>
					<div class="row unauth-config-block">
						<div class="large-12 medium-12 columns">							
							<div class="large-6 medium-6 columns config-name"><label>JIRA Authorized configurations</label></div>
							<div class="large-6 medium-6 columns">
								<!--<button class="secondary button" id="add-config">Add</button>-->
							</div>					
						</div>
					</div>
					<div id="unauth-instance-list-block" class="row unauth-instance-list-block">						
					</div>
				</div>
			</div>
			<div id="authenticate-block" style="display:none">
				<form name="form1" id="form1">
					<div class="row">
						<div class="large-12 medium-12 columns jira-steps">
							<label><b>Step 1</b></label>
						</div>
						<div class="large-2 medium-3 columns"><label class="label-config">JIRA Base URL:
						<span class="has-tip tip-right jira-baseurl-tooltip" id="tooltip" title="Your JIRA account domain." data-tooltip><img class="tool-tip"></span></label>
						</div>
						<div class="large-8 medium-6 columns domain-block">
							<div class="large-1 columns medium-2 protocol-block">
								<span id="protocol" class="zendesk-protocol">http://</span>
							</div>
							<div class="large-6 medium-6 columns zendesk-domainName-block">
								<input name="zendesksubdomain" id="zendesksubdomain" type="text">
							</div><span id="domainName" class="zendesk-domainName">.atlassian.net</span>
						</div><br><br><br>
					</div>
					<div class="row">
						<div class="large-12 columns">
							<div class="large-6 medium-7 columns domain-btn">
								<button id="get-authentication" class="button">
									<b>Validate</b>
								</button>
							</div>
						</div>
					</div>
				</form>
				
				<div class="row">
					<div class="large-12 medium-12 columns jira-steps second-step" style="display:none;">
						<label><b>Step 2</b></label>
					</div>
					<div class="large-12 medium-12 columns instructions-config-info" style="display:none;">
						<p>Note: For any JIRA user to use this integration for the provided base URL, JIRA admin should follow the below instructions. Ignore and proceed to step3 to authenticate JIRA account, if the JIRA admin has already finished this setup.</p><br>
						<p><span class="" id="intruction-expand-close-config" title=""> &nbsp;</span><span id="config-label">JIRA Admin Instructions.</span></p>
					</div>
					<div id="showSetup">
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step A</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>Enter your JIRA account credentials  and click <b>Log in</b> button.</p><br>
								<img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruction01.png" class="setup-image">
							</div>
						</div>
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step B</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>Click <b>Allow</b> button.</p><br>
								<img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruc02.png" class="setup-image">
							</div>
						</div>
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step C</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>Click on settings icon and click <b>Applications</b>.</p><br>
								<img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruc111.png" class="setup-image">
							</div>
						</div>
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step D</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>In left panel, under <b>Integrations</b> click <b>Application links</b>.</p><br>
								<img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruc222.png" class="setup-image">
							</div>
						</div>
						
						
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step E</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>Type URL www.ciscospark.com into input field and then click <b>Create new link</b>.</p><br>
								<img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruc03.png" class="setup-image">
							</div>
						</div><br>
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step F</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>Enter URL as above in <b>New URL</b> filed and click <b>Continue</b>.</p>
								<br><img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruc04.png" class="setup-image">
							</div>
						</div>
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step G</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>Look to the Right, enter what you see for each field. Double check the inputs to make sure they are correct. Click <b>Continue</b>.</p><br>
								<div class="large-5 medium-5 columns">
									<img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruc05.png" class="setup-image">
								</div>
								<div class="large-7 medium-7 columns">
									<div class="large-2 medium-2 columns">
										<label><b>Application Name</b></label>
									</div>
									<div class="large-9 medium-9 columns">
										<input type="text" name="applicationName" id="applicationName" value="Cisco Spark" readonly>
														<a href="javascript:void(0)" id="applicationNameCopy">Copy App Name</a>	
									</div>
								</div><br>
								<div class="large-7 medium-7 columns">
									<div class="large-2 medium-2 columns">
										<label><b>Application Type</b></label>
									</div>
									<div class="large-9 medium-9 columns">
										<input type="text" name="applicationType" id="applicationType" value="Generic Application" readonly>
									</div>
								</div><br>
								<div class="large-7 medium-7 columns">
									<div class="large-2 medium-2 columns">
										<label><b>Service Provider Name</b></label>
									</div>
									<div class="large-9 medium-9 columns">
										<input type="text" name="serviceProviderName" id="serviceProviderName" value="Cisco Spark" readonly>
											<a href="javascript:void(0)" id="serviceProviderNamecopy">Copy Service Provider Name</a>	
									</div>
								</div><br>
								<div class="large-7 medium-7 columns">
									<div class="large-2 medium-2 columns">
										<label><b>Consumer Key</b></label>
									</div>
									<div class="large-9 medium-9 columns">
										<input type="text" name="consumerKey" id="consumerKey" value="hardcoded-consumer" readonly>
														<a href="javascript:void(0)" id="consumercopy">Copy Consumer Key</a>	
									</div>
								</div><br>
								<div class="large-7 medium-7 columns">
									<div class="large-2 medium-2 columns">
										<label><b>Shared Secret</b></label>
									</div>
									<div class="large-9 medium-9 columns">
										<input type="text" name="sharedSecret" id="sharedSecret" value="1232429789797" readonly>
														<a href="javascript:void(0)" id="sharedcopy">Copy Shared Secret</a>	
									</div>
								</div><br>
								<div class="large-7 medium-7 columns">
									<div class="large-2 medium-2 columns">
										<label><b>Request Token URL</b></label>
									</div>
									<div class="large-9 medium-9 columns">
										<input type="text" name="reqTokenURL" id="reqTokenURL" value="https://www.ciscospark.com/" readonly>
														<a href="javascript:void(0)" id="reqtokencopy">Copy URL</a>	
									</div>
								</div><br>
								<div class="large-7 medium-7 columns">
									<div class="large-2 medium-2 columns">
										<label><b>Access Token URL</b></label>
									</div>
									<div class="large-9 medium-9 columns">
										<input type="text" name="accTokenURL" id="accTokenURL" value="https://www.ciscospark.com/" readonly>
														<a href="javascript:void(0)" id="acctokencopy">Copy URL</a>	
									</div>
								</div><br>
								<div class="large-7 medium-7 columns">
									<div class="large-2 medium-2 columns">
										<label><b>Authorize URL</b></label>
									</div>
									<div class="large-9 medium-9 columns">
										<input type="text" name="authURL" id="authURL" value="https://www.ciscospark.com/" readonly>
														<a href="javascript:void(0)" id="authcopy">Copy URL</a>	
									</div>
								</div>
							</div>
						</div>
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step H</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>Click on "Edit" icon as highlihted below.</p><br>
								<img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruc06.png" class="setup-image">
							</div>
						</div>
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step I</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>Click <b>Incoming Authentication</b> in left Panel.</p><br>
								<img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruc07.png" class="setup-image">
							</div>
						</div>
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step J</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>Copy <b>Consumer Key</b> and paste it in <b>Consumer Key</b> field and Enter <b>Consumer Name</b> as "Cisco Spark."</p><br>
								<div class="large-10 medium-10 columns">
									<div class="large-3 medium-3 columns">
										<label><b>Consumer Key</b></label>
									</div>
									<div class="large-9 medium-9 columns">
										<input type="text" name="consumerKey" id="consumerKey" value="hardcoded-consumer" readonly>
										<a href="javascript:void(0)" id="consumercopy">Copy Consumer Key</a>	
									</div>
								</div>
								<img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruc08.png" class="setup-image">
							</div>
						</div>
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step K</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>Copy the provided <b>Public Key</b> below and Paste it in <b>Public Key</b> field.</p><br>
								<div class="large-10 medium-10 columns">
									<div class="large-3 medium-3 columns">
										<label><b>Public Key</b></label>
									</div>
									<div class="large-9 medium-9 columns">
										<input type="text" name="publicKey" id="publicKey" value="fdasfadsfasfasfa252542354234sgfgfbnsd523tbsdg5623" readonly>
										<a href="javascript:void(0)" id="publiccopy">Copy Public Key</a>		
									</div>
								</div>
								<img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruc09.png" class="setup-image">
							</div>
						</div>
						<div class="large-12 columns sub-config-block">
							<div class="large-1 medium-1 columns step">
								<label><b>Step L</b></label>
							</div>
							<div class="large-11 medium-11 columns step-text">
								<p>Copy the provided <b>Callback URL</b> below and Paste it in <b>Consumer Callback URL</b> field.</p><br>
								<div class="large-10 medium-10 columns">
									<div class="large-3 medium-3 columns">
										<label><b>Callback URL</b></label>
									</div>
									<div class="large-9 medium-9 columns">
										<input type="text" name="callBackURL" id="callBackURL" value="https://depot.ciscospark.com/integrations/Y2lzY29zcGFyazovL3VzL0FQUExJQ0FUSU9OL0M4MDhhY2YzNTA1NjFiNjg5NmNkYWJhOWEzMjg5MDYwYWU2Y2E5YWRmODZmNDVlNGZlMzQ3ZTgxNDY4NWQ2ODA3" readonly>
										<a href="javascript:void(0)" id="callbackcopy">Copy URL</a>		
									</div>
								</div>
								<img alt="" src="https://183.82.99.100:8443/CiscoWebcontent/images/jira/jira-instruc10.png" class="setup-image">
							</div>
						</div>
					</div><br>
					<div class="large-12 columns sub-config-block jira-auth-btn" style="display:none;">
						<div class="large-1 medium-1 columns step">
							<label><b>Step 3</b></label>
						</div>
						<div class="large-4 medium-4 columns step-text">
							<p>Authenticate your JIRA account</p>
						</div>
						<div class="large-12 medium-12 columns " style="">
							<button id="authenticate-btn" class="button">
								<b>Authenticate</b>
							</button>
						</div>
					</div>
				</div>
			</div>
			<div class="large-12 columns" id="integration-form" >
				<div class="large-12 medium-12 columns edit-roomconfig-info" style="display:none">
					<p><span class="info-icon" title=""> &nbsp;</span><span>Previously configured space does not exist.</span></p>
				</div>
				<div class="large-12 medium-12 columns bot-err-msg" style="display:none">
					<p><span class="info-icon" title=""> &nbsp;</span><span>We are facing difficultiy while adding Bot to Selected Room. Make sure you have isModerate permission.</span><span class="red_cross_mark" title="">&nbsp;</span></p>
				</div>
				<div class="row jira-domain-block">
					<div class="large-12 columns">
						<div class="large-2 medium-3 columns"><label class="label-config">JIRA Base URL</label></div>
						<div class="large-10 medium-9 columns">
							<div class="large-5 medium-5 columns zendeskdomain-text">
							  
							</div>
							<div class="large-5 medium-5 columns" style="display:none;">
							  <input type="text" name="zendeskdomain" id="zendeskdomain" readonly/>
							</div>
						</div>
					</div>
				</div><br>
				<form name="form" id="form" method="post">
					<div class="row app-config-block jira-auth">
						<div class="large-12 medium-12 columns jira-steps">
							<label><b>Step 4</b></label>
						</div>
						<div class="row spark-config-block">
							<div class="large-10 medium-10 columns">
								<h3 class="heading-01">Add Bot to Spark</h3>
								<div class="large-8 columns sub-config-block checkbox">
									<input type="checkbox" value="true" name="private_message" id="private_message"><label for="private_message">Private message (only to me)</label>
								</div>
								<div class="large-12 columns sub-config-block left">
									<div class="large-2 medium-2 columns small-mobile">
										<label>Space</label>
									</div>
									<div class="large-5 medium-5 columns text left input-small-mobile">
										<select name="room" id="rooms" class="custom-select">
										<option value='0'>Please Select</option></select><span class="has-tip tip-right" id="tooltip" title="Space in which you'd like to receive notifications. Ensure newly created spaces have at least one message in it for it to show up here."
											data-tooltip><img class="tool-tip"></span>
									</div>
									<div class="rooms-loading" style="display: none;"></div>
								</div>	
							</div>
							<div class="large-10 medium-10 columns">
								<button id="add-bot-button" class="button secondary text">Add Bot</button>
							</div>
							<input type="hidden" name="instanceid" id="instanceid" value="">
						</div>
						<div>&nbsp;</div>
						<div class="row app-config-block">
							<div class="large-12 medium-12 columns jira-steps">
								<label><b>Step 5 (Optional)</b></label>
							</div>
							<div class="large-12 medium-12 columns"><label class="heading-01">JIRA Notification Configuration</label></div>	
								<div class="large-12 medium-12 columns">
									<div class="large-8 jira-config-name left">
										<div class="large-4 medium-4 columns small-mobile config-optional">
											<label>Configuration name (optional)</label>
										</div>
										<div class="large-5 medium-5 columns text left input-small-mobile">
											<input type="text" name="displayName" id="displayName" class="integration-name"	value="">
										</div>							
									</div>	
								</div>
								<div class="large-12 medium-12 columns">
									<div class="large-12 columns sub-config-block" style="display:block;">
										<div class="large-2 medium-2 columns items-config">
											<label class="label-config">Projects:</label>
										</div>
										<div  class="large-9 medium-8 columns text left projects ">
											<div  class="large-5 medium-5 columns projects">
												<select id="projects" class="dropdown">
														<option value="0" >Please Select</option>
														<option value="project1" >project1</option>
														<option value="project2" >project2</option>
														<option value="project3" >project3</option>
												</select>
											</div>	
											<div  class="large-4 medium-4 left">
												<span class="has-tip tip-right multicheckbox-tooltip" id="tooltip" title="Projects, for which you'd receive notifications for this configuration." data-tooltip><img class="tool-tip"></span>
											</div>											
										</div>
									</div>
									<div class="large-12 columns sub-config-block unautheissuetypesblock" style="display:none;">
										<div class="large-3 medium-4 columns items-config">
											<label class="label-config">Issue Types:</label>
										</div>
										<div  class="large-9 medium-8 columns text left issutypes multicheckbox-input-small-mobile">
											<div  class="large-5 medium-5 columns issuetypes">
												<select multiple="multiple" id="issuetypes" class="dropdown">
													<optgroup id="issue-types-options" label="" id="">
														<option value="All" >All</option>
														<option value="bug">Bug</option>
														<option value="change">Change</option>
														<option value="story">Story</option>
														<option value="task">Task</option>
														<option value="epic">Epic</option>
														<option value="incident">Incident</option>
														<option value="servicerequest">Service Request</option>
														<option value="problem">Problem</option>
													</optgroup>
												</select>
											</div>	
											<div  class="large-4 medium-4 left">
												<span class="has-tip tip-right multicheckbox-tooltip" id="tooltip" title="IssueTypes, for which you'd receive notifications for this configuration. Choose 'All' checkbox, if you don't find your IssueTypes." data-tooltip><img class="tool-tip"></span>
											</div>											
										</div>
									</div>
									<!--<div class="large-12 columns sub-config-block">
										<div class="large-3 medium-4 columns items-config issue-transtioned-text">
											<label class="label-config">Issue transitioned to:</label>
										</div>
										<div  class="large-9 medium-8 columns text left multicheckbox-input-small-mobile">
											<div  class="large-5 medium-5 columns issuestatus">
												<select multiple="multiple" id="issuestatus" class="dropdown">
													<optgroup id="issue-status-options" label="" id="">
														<option value="done" >Done</option>
														<option value="inprogress" >In progress</option>
														<option value="todo" >To Do</option>
														<option value="awaitingapproval" >Awaiting approval</option>
														<option value="waitingforsupport">Waiting for support</option>
														<option value="resolved">Resolved</option>
													</optgroup>
												</select>
											</div>	
											<div  class="large-4 medium-4 left">
												<span class="has-tip tip-right multicheckbox-tooltip" id="tooltip" title="IssueStatus, for which you'd receive notifications for this configuration" data-tooltip><img class="tool-tip"></span>
											</div>
										</div>	
									</div>	-->
									<div class="large-10 columns sub-config-block">
										<div class="large-10 medium-12 columns">
												<label class="label-config">Status Changes <span class="has-tip tip-right jira-statuschange-tooltip" id="tooltip" title="For the chosen issue types, specify which status changes should post a notification. Use * symbol to represent all statuses." data-tooltip><img class="tool-tip"></span></label>
										</div>
										<div class="large-10 medium-12 columns" id="authNotificationList">
											<div></div>
										</div>
										<div class="large-12 medium-12 columns customstatus-add-div">
											<div class="large-0 medium-8 columns customstatus-add-btn">
												<a id="add_status" href="javascript:void(0)" style="font-size:12px;float:right;">+ Add</a>
											</div>
										</div>
									</div>	
									<div class="large-12 columns events-config">
										<div class="large-12 medium-12 columns events">
											<label>Notifications: Comments <span class="has-tip tip-right jira-event-tooltip" id="tooltip" title="For the chosen issue types, select appropriate comment notifications." data-tooltip="shupm2-tooltip" aria-describedby="l5sa71-tooltip" data-yeti-box="l5sa71-tooltip" data-toggle="l5sa71-tooltip" data-resize="l5sa71-tooltip" data-events="resize"><img class="tool-tip"></span></label>
											<div class="events-sub " id="events">
												<div class="large-12 medium-12 columns">
													<div class="large-6 medium-6 columns checkbox"><input type="checkbox" class="events comments-checkbox" id="newcomment" name="events" value="newcomment"/>
													<label for="newcomment">New Comment</label></div>
												</div> 
												<div class="large-12 medium-12 columns">
													<div class="large-12 medium-2 columns">
														<div class="large-12 medium-2 columns">
															<div class="large-6 medium-6 columns checkbox"><input type="checkbox" class="events comments-checkbox" id="restricted-comments" name="events" value="restricted-comments"/>
															<label for="restricted-comments">Include restricted comments</label></div>
														</div>
													</div>
												</div>
												<div class="large-12 medium-12 columns">
													<div class="large-12 medium-2 columns">
														<div class="large-12 medium-2 columns">
															<div class="large-6 medium-6 columns checkbox"><input type="checkbox" class="events comments-checkbox" id="comment-edits" name="events" value="comment-edits"/>
															<label for="comment-edits">Include comment edits</label></div>
														</div>
													</div>
												</div> 
											 </div>
										</div>
										<div class="large-12 medium-12 columns">&nbsp;</div>
										<div class="large-12 medium-12 columns events">
											<label>Notifications: Other events <span class="has-tip tip-right jira-event-tooltip" id="tooltip" title="For the chosen issue types, select appropriate update notifications. Select All option to receive all the updates associated with the issue beyond the commonly used options listed here." data-tooltip="shupm2-tooltip" aria-describedby="l5sa71-tooltip" data-yeti-box="l5sa71-tooltip" data-toggle="l5sa71-tooltip" data-resize="l5sa71-tooltip" data-events="resize"><img class="tool-tip"></span></label>
											<div class="events-sub" id="other_notifications">
												<div class="large-12 medium-12 columns">
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="all" value="all" class="allevent-disable"><label for="all">All</label>
													</div>
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="board-update" value="board" class="otherevent-disable"><label for="board-update">Board</label>
													</div>
												</div>
												<div class="large-12 medium-12 columns">
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="priority-update" value="priority" class="otherevent-disable"><label for="priority-update">Priority</label>
													</div>
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="assignee-change" value="assignee" class="otherevent-disable"><label for="assignee-change">Assignee</label>
													</div>
												</div>
												<div class="large-12 medium-12 columns">
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="description-update" value="description" class="otherevent-disable"><label for="description-update">Description</label>
													</div>
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="attachment" value="attachment" class="otherevent-disable"><label for="attachment">Attachment</label>
													</div>
												</div>
												<div class="large-12 medium-12 columns">
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="sprint-update" value="sprint" class="otherevent-disable"><label for="sprint-update">Sprint</label>
													</div>
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="version-change" value="fixversion" class="otherevent-disable"><label for="version-change">Fix version</label>
													</div>
												</div>
											</div>
											<div class="large-12 medium-12 columns">&nbsp;</div>
											<div class="large-12 medium-12 columns " style="margin-right:15px">
												<div class="large-3 medium-3 columns left">
													<label>Other Event Names</label>
												</div>
												<div class="large-4 medium-3 columns left other-event-text">
													<input type="text" id="other-event-name" class="otherevent-disable">
													<a style="float:right;font-size:12px" href="javascript:void(0)" id="add-other-events" >+ Add</a>
												</div>
												<span class="has-tip tip-right other-events-tooltip" id="tooltip" title="For the chosen issue types, enter the custom field names for which also you'd like to receive notifications for." data-tooltip><img class="tool-tip"></span>
											</div>
										</div>
										
									</div>
								</div>
								<div class="large-12 medium-12 columns config-info" style="display:none;">
									<p><span class="" id="expand-close-config" title=""> &nbsp;</span><span id="config-label">You have to be a JIRA admin to add this configuration. Please follow the below steps to add this configuration. You can add/edit/delete multiple configurations at anytime.</span></p>
								</div>
								<div id="showConfig" style="display:none;">
									<div class="large-12 columns sub-config-block">
										<div class="large-1 medium-1 columns step">
											<label><b>Step A</b></label>
										</div>
										<div class="large-11 medium-11 columns step-text">
											<p>Login into your JIRA account as Admin. Click on the settings icon and select <b>System</b> as shown.</p><br>
											<img alt="" src="https://d24wgzqqegxpap.cloudfront.net/api/images/jira/jira-1.png" class="setup-image">
										</div>
									</div>
									<div class="large-12 columns sub-config-block">
										<div class="large-1 medium-1 columns step">
											<label><b>Step B</b></label>
										</div>
										<div class="large-11 medium-11 columns step-text">
											<p>If you are requested to login, use your admin credentials.</p><br>
											<img alt="" src="https://d24wgzqqegxpap.cloudfront.net/api/images/jira/jira-2.png" class="setup-image">
										</div>
									</div>
									<div class="large-12 columns sub-config-block">
										<div class="large-1 medium-1 columns step">
											<label><b>Step C</b></label>
										</div>
										<div class="large-11 medium-11 columns step-text">
											<p>In the left panel under <b>ADVANCED</b> section, click on <b>WebHooks</b>.</p><br>
											<img alt="" src="https://d24wgzqqegxpap.cloudfront.net/api/images/jira/jira-3.png" class="setup-image">
										</div>
									</div><br>
									<div class="large-12 columns sub-config-block">
										<div class="large-1 medium-1 columns step">
											<label><b>Step D</b></label>
										</div>
										<div class="large-11 medium-11 columns step-text">
											<p>Click on <b>Create a WebHook</b> at top right corner.</p>
											<ul type="disc">
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;Enter <b>Name</b> of your choice.</li>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;Paste below Webhook URL into the <b>URL</b> text box.</li>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;In <b>Events</b> section text box, follow below Syntax to add projects for which you'd like to receive alerts.</li>
											</ul>
											<p>Syntax: <b>Project=&lt;project-name&gt;</b> for single project and  
												<b>Project=&lt;project-name&gt; OR Project=&lt;project-name&gt;</b> for multiple projects.</p>
											<ul>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;Under Issue, select created, updated and/or deleted.</li>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp; If you have chosen to receive comment updates related to issues in the above checkboxes, then under Comments on JIRA side, unselect created, updated and deleted. If not, you'd receive dual notifications in your configured Cisco Spark space - one for the comment alone and other for a comment update related to the issue. </li>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;If you intend to receive notifications for Sprints, Boards and other Project/User related events, ensure to select those options for the wehbook and also in the above section named ‘Notifications – Other events’.</li>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;Click <b>Save</b>.</li>
											</ul><br>
												<div class="large-12 columns">
													<div class="large-2 medium-2 columns">
														<label style="margin:7px;">Webhook URL :</label>
													</div>
													<div class="large-10 medium-10 columns">
														<input type="text" name="webhookURL" id="webhookURL" value="" readonly>
														<a href="javascript:void(0)" id="copy">Copy URL</a>			
													</div>
												</div><br><br>
												<img alt="" src="https://d24wgzqqegxpap.cloudfront.net/api/images/jira/jira-4.png" class="setup-image">
												<img alt="" src="https://cisco-spark-integration-webcontent-prod.cloudhub.io/api/images/jira/jira-5.png" class="setup-image">
										</div>
									</div>
								</div>
						</div>	
						<div class="row integration-config-block">
							<div class="large-5 medium-5 columns"> &nbsp;</div>
							<div class="large-4 medium-4 columns left">
								<button id="cancel-button" class="button">Cancel</button>
								<button id="submit-button" class="button secondary text">Add Integration</button>
							</div>
						</div>
					</div>
					<div class="row app-config-block jira-unauth" style="display:none;">
						<div class="row app-config-block">
							<div class="large-12 medium-12 columns"><label class="heading-01">JIRA configuration</label></div>	
								<div class="large-12 medium-12 columns">
									<div class="large-10 medium-12 columns sub-config-block">
										<div class="large-5 medium-6 columns left">
											<div class="large-6 medium-8 columns unauthissuetypes">
												<label class="label-config">Issue Types:</label>
													<select multiple="multiple" id="unauth-issuetypes" class="dropdown" name="">
														<optgroup id="unauth-issue-types-options" label="" >
															<option value="All" >All</option>
															<option value="bug" >Bug</option>
															<option value="change">Change</option>
															<option value="story">Story</option>
															<option value="task">Task</option>
															<option value="epic">Epic</option>
															<option value="incident">Incident</option>
															<option value="servicerequest">Service Request</option>
															<option value="problem">Problem</option> 
														</optgroup>
													</select>
											</div>
										</div>
										<div class="large-5 medium-6 columns add-custom-type left" >
											<div class="large-6 medium-12 columns">
												<label class="label-config">&nbsp;</label>
												<div class="large-6 medium-10 columns">
													<input type="text" id="customtype_field"  name="">	
													<a style="float:right;font-size:12px" href="javascript:void(0)" id="add_customtypes">+ Add</a>
												</div>
												<span class="has-tip tip-right issutypes" id="tooltip" title="Notifications will be sent only for the selected issue types." data-tooltip><img class="tool-tip"></span>
											</div>
										</div>
									</div>
									<div class="large-10 columns sub-config-block">
										<div class="large-10 medium-12 columns">
												<label class="label-config">Status Changes <span class="has-tip tip-right jira-statuschange-tooltip" id="tooltip" title="For the chosen issue types, specify which status changes should post a notification. Use * symbol to represent all statuses." data-tooltip><img class="tool-tip"></span></label>
										</div>
										<div class="large-10 medium-12 columns" id="notificationList">
											<div></div>
										</div>
										<div class="large-12 medium-12 columns customstatus-add-div">
											<div class="large-0 medium-8 columns customstatus-add-btn">
												<a id="add_status" href="javascript:void(0)" style="font-size:12px;float:right;">+ Add</a>
											</div>
										</div>
									</div>				
									<div class="large-12 columns events-config">
										<div class="large-12 medium-12 columns events">
											<label>Notifications: Comments <span class="has-tip tip-right jira-event-tooltip" id="tooltip" title="For the chosen issue types, select appropriate comment notifications." data-tooltip="shupm2-tooltip" aria-describedby="l5sa71-tooltip" data-yeti-box="l5sa71-tooltip" data-toggle="l5sa71-tooltip" data-resize="l5sa71-tooltip" data-events="resize"><img class="tool-tip"></span></label>
											<div class="events-sub " id="events">
												<div class="large-12 medium-12 columns">
													<div class="large-6 medium-6 columns checkbox"><input type="checkbox" class="events comments-checkbox" id="unauth-newcomment" name="events" value="newcomment"/>
													<label for="unauth-newcomment">New Comment</label></div>
												</div> 
												<div class="large-12 medium-12 columns">
													<div class="large-12 medium-2 columns">
														<div class="large-12 medium-2 columns">
															<div class="large-6 medium-6 columns checkbox"><input type="checkbox" class="events comments-checkbox" id="unauth-restricted-comments" name="events" value="restricted-comments"/>
															<label for="unauth-restricted-comments">Include restricted comments</label></div>
														</div>
													</div>
												</div>
												<div class="large-12 medium-12 columns">
													<div class="large-12 medium-2 columns">
														<div class="large-12 medium-2 columns">
															<div class="large-6 medium-6 columns checkbox"><input type="checkbox" class="events comments-checkbox" id="unauth-comment-edits" name="events" value="comment-edits"/>
															<label for="unauth-comment-edits">Include comment edits</label></div>
														</div>
													</div>
												</div> 
											 </div>
										</div>
										<div class="large-12 medium-12 columns">&nbsp;</div>
										<div class="large-12 medium-12 columns events">
											<label>Notifications: Other events <span class="has-tip tip-right jira-events-tooltip" id="tooltip" title="For the chosen issue types, select appropriate update notifications. Select All option to receive all the updates associated with the issue beyond the commonly used options listed here." data-tooltip="shupm2-tooltip" aria-describedby="l5sa71-tooltip" data-yeti-box="l5sa71-tooltip" data-toggle="l5sa71-tooltip" data-resize="l5sa71-tooltip" data-events="resize"><img class="tool-tip"></span></label>
											<div class="events-sub" id="other_notifications">
												<div class="large-12 medium-12 columns">
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="all" value="all" class="allevent-disable"><label for="all">All</label>
													</div>
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="unauth-board-update" value="board" class="otherevent-disable"><label for="unauth-board-update">Board</label>
													</div>
												</div>
												<div class="large-12 medium-12 columns">
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="unauth-priority-update" value="priority" class="otherevent-disable"><label for="unauth-priority-update">Priority</label>
													</div>
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="unauth-assignee-change" value="assignee" class="otherevent-disable"><label for="unauth-assignee-change">Assignee</label>
													</div>
												</div>
												<div class="large-12 medium-12 columns">
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="unauth-description-update" value="description" class="otherevent-disable"><label for="unauth-description-update">Description</label>
													</div>
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="unauth-attachment" value="attachment" class="otherevent-disable"><label for="unauth-attachment">Attachment</label>
													</div>
												</div>
												<div class="large-12 medium-12 columns">
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="unauth-sprint-update" value="sprint" class="otherevent-disable"><label for="unauth-sprint-update">Sprint</label>
													</div>
													<div class="large-3 medium-4 columns checkbox">
														<input type="checkbox" name="events" id="unauth-version-change" value="fixversion" class="otherevent-disable"><label for="unauth-version-change">Fix version</label>
													</div>
												</div>
											</div>
											<div class="large-12 medium-12 columns">&nbsp;</div>
											<div class="large-12 medium-12 columns " style="margin-right:15px">
												<div class="large-5 medium-4 columns left">
													<label>Other Event Names</label>
												</div>
												<div class="large-5 medium-4 columns left other-event-text">
													<input type="text" id="other-event-name" class="otherevent-disable">
													<a style="float:right;font-size:12px" href="javascript:void(0)" id="add-other-events" >+ Add</a>
												</div>
												<span class="has-tip tip-right other-events-tooltip" id="tooltip" title="For the chosen issue types, enter the custom field names for which also you'd like to receive notifications for." data-tooltip><img class="tool-tip"></span>
											</div>
										</div>
									</div>
								</div>
								<div class="large-12 medium-12 columns unauth-config-info" style="display:none;">
									<p><span class="" id="unauth-expand-close-config" title=""> &nbsp;</span><span id="config-label">You have to be a JIRA admin to add this configuration. Please follow the below steps to add this configuration. You can add/edit/delete multiple configurations at anytime.</span></p>
								</div>
								<div id="unauth-showConfig" style="display:none;">
									<div class="large-12 columns sub-config-block">
										<div class="large-1 medium-1 columns step">
											<label><b>Step A</b></label>
										</div>
										<div class="large-11 medium-11 columns step-text">
											<p>Login into your JIRA account as Admin. Click on the settings icon and select <b>System</b> as shown.</p><br>
											<img alt="" src="https://d24wgzqqegxpap.cloudfront.net/api/images/jira/jira-1.png" class="setup-image">
										</div>
									</div>
									<div class="large-12 columns sub-config-block">
										<div class="large-1 medium-1 columns step">
											<label><b>Step B</b></label>
										</div>
										<div class="large-11 medium-11 columns step-text">
											<p>If you are requested to login, use your admin credentials.</p><br>
											<img alt="" src="https://d24wgzqqegxpap.cloudfront.net/api/images/jira/jira-2.png" class="setup-image">
										</div>
									</div>
									<div class="large-12 columns sub-config-block">
										<div class="large-1 medium-1 columns step">
											<label><b>Step C</b></label>
										</div>
										<div class="large-11 medium-11 columns step-text">
											<p>In the left panel under <b>ADVANCED</b> section, click on <b>WebHooks</b>.</p><br>
											<img alt="" src="https://d24wgzqqegxpap.cloudfront.net/api/images/jira/jira-3.png" class="setup-image">
										</div>
									</div><br>
									<div class="large-12 columns sub-config-block">
										<div class="large-1 medium-1 columns step">
											<label><b>Step D</b></label>
										</div>
										<div class="large-11 medium-11 columns step-text">
											<p>Click on <b>Create a WebHook</b> at top right corner.</p>
											<ul type="disc">
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;Enter <b>Name</b> of your choice.</li>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;Paste below Webhook URL into the <b>URL</b> text box.</li>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;In <b>Events</b> section text box, follow below Syntax to add projects for which you'd like to receive alerts.</li>
											</ul>
											<p>Syntax: <b>Project=&lt;project-name&gt;</b> for single project and  
												<b>Project=&lt;project-name&gt; OR Project=&lt;project-name&gt;</b> for multiple projects.</p>
											<ul>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;Under Issue, select created, updated and/or deleted.</li>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp; If you have chosen to receive comment updates related to issues in the above checkboxes, then under Comments on JIRA side, unselect created, updated and deleted. If not, you'd receive dual notifications in your configured Cisco Spark space - one for the comment alone and other for a comment update related to the issue. </li>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;If you intend to receive notifications for Sprints, Boards and other Project/User related events, ensure to select those options for the wehbook and also in the above section named ‘Notifications – Other events’.</li>
												<li>&#9679;&nbsp;&nbsp;&nbsp;&nbsp;Click <b>Save</b>.</li>
											</ul><br>
												<div class="large-12 columns">
													<div class="large-2 medium-2 columns">
														<label style="margin:7px;">Webhook URL :</label>
													</div>
													<div class="large-10 medium-10 columns">
														<input type="text" name="webhookURL" id="webhookURL" value="" readonly>
														<a href="javascript:void(0)" id="copy">Copy URL</a>			
													</div>
												</div><br><br>
												<img alt="" src="https://d24wgzqqegxpap.cloudfront.net/api/images/jira/jira-4.png" class="setup-image">
												<img alt="" src="https://cisco-spark-integration-webcontent-prod.cloudhub.io/api/images/jira/jira-5.png" class="setup-image">
										</div>
									</div>
								</div>
						</div>	
						<div class="row spark-config-block">
							<div class="large-10 medium-10 columns">
								<h3 class="heading-01">Cisco Spark configuration</h3>
								<div class="large-8 columns sub-config-block">
									<div class="large-3 medium-3 columns small-mobile">
										<label>Space</label>
									</div>
									<div class="large-5 medium-5 columns text left input-small-mobile">
										<select name="room" id="unauthrooms" class="custom-select">
										<option value='0'>Please Select</option></select><span class="has-tip tip-right" id="tooltip" title="Space in which you'd like to receive notifications. Ensure newly created spaces have at least one message in it for it to show up here."
											data-tooltip><img class="tool-tip"></span>
									</div>
									<div class="rooms-loading" style="display: none;"></div>
								</div>
								<div class="large-8 columns sub-config-block left">
									<div class="large-3 medium-3 columns small-mobile config-optional">
										<label>Configuration name (optional)</label>
									</div>
									<div class="large-5 medium-5 columns text left input-small-mobile">
										<input type="text" name="displayName" id="displayName" class="integration-name"	value="">
									</div>							
								</div>
								<input type="hidden" name="instanceid" id="instanceid" value="">			
							</div>
						</div>
						<div class="row integration-config-block">
							<div class="large-5 medium-5 columns"> &nbsp;</div>
							<div class="large-4 medium-4 columns left">
								<button id="unauth-cancel-button" class="button">Cancel</button>
								<button id="unauth-submit-button" class="button secondary text">Add Configuration</button>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</body>
</html>